(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5738],{86611:function(e,t,n){Promise.resolve().then(n.bind(n,48072))},48072:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return et}});var i=n(57437),o=n(2265),r=n(8319),s=n(38543),l=n(90658),a=n(18150),c=n(36261),d=n(77639),u=n(36003),h=n(60034),g=n(19352),x=n(41563),m=n(61002),j=n(33101),Z=n(82995),f=n(68045),p=n(66838),v=n(16116),D=n(46382),y=n(16875),k=n(50793),w=n(60370),C=n(95280),b=n(49715),_=n(73985),S=n(66825),z=n(95386),E=n(27648),I=n(89470),A=n(99636),F=n(12961),M=n(67731),T=n(37306),O=n(40196),P=n(19391),B=n(20599),L=n(89010),N=n(64059),R=(0,N.Z)((0,i.jsx)("path",{d:"m10 16.5 6-4.5-6-4.5zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"PlayCircleOutline"),W=n(3484),H=n(44812),V=n(88654),U=n(22347),J=n(9391),Y=n(73088),G=n(4568),q=n(59700),K=(0,N.Z)((0,i.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m-5 14H4v-4h11zm0-5H4V9h11zm5 5h-4V9h4z"}),"Web"),Q=(0,N.Z)((0,i.jsx)("path",{d:"M17 7h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.43-.98 2.63-2.31 2.98l1.46 1.46C20.88 15.61 22 13.95 22 12c0-2.76-2.24-5-5-5m-1 4h-2.19l2 2H16zM2 4.27l3.11 3.11C3.29 8.12 2 9.91 2 12c0 2.76 2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1 0-1.59 1.21-2.9 2.76-3.07L8.73 11H8v2h2.73L13 15.27V17h1.73l4.01 4L20 19.74 3.27 3z"}),"LinkOff"),X=e=>{let{organizationId:t}=e,[n,u]=(0,o.useState)([]),[h,g]=(0,o.useState)([]),[w,E]=(0,o.useState)(!0),[A,F]=(0,o.useState)(null),[M,T]=(0,o.useState)(null),[O,P]=(0,o.useState)(!1),[B,L]=(0,o.useState)(""),[N,R]=(0,o.useState)(""),[W,H]=(0,o.useState)(!1),X=async()=>{if(t){E(!0),F(null);try{let e=await fetch("/api/monitoring/associate?organization_id=".concat(t));if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch associations")}let n=await e.json();u(n.associations||[]),g(n.available_services||[])}catch(e){console.error("Error fetching associations:",e),F(e.message)}finally{E(!1)}}};(0,o.useEffect)(()=>{X()},[t]);let $=async()=>{if(!B){F("Please select a monitoring check");return}H(!0),F(null);try{let e=await fetch("/api/monitoring/associate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({monitoringCheckId:B,serviceId:N||null,organizationId:t})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to create association")}let n=await e.json();T(n.message),P(!1),L(""),R(""),X()}catch(e){console.error("Error creating association:",e),F(e.message)}finally{H(!1)}},ee=async e=>{try{let n=await fetch("/api/monitoring/associate?monitoring_check_id=".concat(e,"&organization_id=").concat(t),{method:"DELETE"});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to remove association")}let i=await n.json();T(i.message),X()}catch(e){console.error("Error removing association:",e),F(e.message)}},et=e=>{switch(e){case"operational":return"success";case"degraded":return"warning";case"down":return"error";case"maintenance":return"info";default:return"default"}},en=()=>n.filter(e=>!e.linked_service_id);return w?(0,i.jsx)(s.Z,{display:"flex",justifyContent:"center",p:4,children:(0,i.jsx)(r.Z,{})}):(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(s.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,i.jsxs)(l.Z,{variant:"h6",component:"h2",children:[(0,i.jsx)(G.Z,{sx:{mr:1,verticalAlign:"middle"}}),"Monitoring & Service Associations"]}),(0,i.jsx)(d.Z,{variant:"contained",startIcon:(0,i.jsx)(I.Z,{}),onClick:()=>P(!0),disabled:0===en().length,children:"Create Association"})]}),A&&(0,i.jsx)(j.Z,{severity:"error",sx:{mb:2},onClose:()=>F(null),children:A}),M&&(0,i.jsx)(j.Z,{severity:"success",sx:{mb:2},onClose:()=>T(null),children:M}),(0,i.jsx)(x.Z,{children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(l.Z,{variant:"subtitle1",gutterBottom:!0,children:"Active Associations"}),(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"When monitoring checks fail, they will automatically update the status of linked services on your status pages."}),0===n.length?(0,i.jsxs)(s.Z,{textAlign:"center",py:4,children:[(0,i.jsxs)(j.Z,{severity:"info",sx:{mb:3,textAlign:"left"},children:[(0,i.jsx)(l.Z,{variant:"body2",gutterBottom:!0,children:(0,i.jsx)("strong",{children:"No monitoring checks found for this organization."})}),(0,i.jsx)(l.Z,{variant:"body2",gutterBottom:!0,children:"Monitoring checks test your services automatically and can update status page services when issues are detected."}),(0,i.jsx)(l.Z,{variant:"body2",children:"Create monitoring checks first, then return here to link them to your status page services."})]}),(0,i.jsxs)(s.Z,{sx:{mt:3,p:3,backgroundColor:"grey.50",borderRadius:2},children:[(0,i.jsx)(l.Z,{variant:"h6",gutterBottom:!0,color:"primary",children:"Get Started with Monitoring"}),(0,i.jsx)(l.Z,{variant:"body2",gutterBottom:!0,sx:{mb:2},children:"Follow these steps to set up automated service monitoring:"}),(0,i.jsx)(s.Z,{sx:{textAlign:"left",mb:3},children:(0,i.jsxs)(l.Z,{variant:"body2",component:"div",sx:{"& strong":{color:"primary.main"}},children:[(0,i.jsx)("strong",{children:"Step 1:"})," Create monitoring checks for your critical services (websites, APIs, databases)",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:"Step 2:"})," Return to this page to associate checks with status page services",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:"Step 3:"})," When monitoring detects issues, service status updates automatically",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:"Step 4:"})," Your users see real-time status updates on your status page"]})}),(0,i.jsxs)(s.Z,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[(0,i.jsx)(d.Z,{variant:"contained",startIcon:(0,i.jsx)(I.Z,{}),href:"/monitoring/new",target:"_blank",rel:"noopener noreferrer",size:"large",children:"Create Your First Check"}),(0,i.jsx)(d.Z,{variant:"outlined",href:"/monitoring",target:"_blank",rel:"noopener noreferrer",children:"View All Monitoring"})]})]})]}):(0,i.jsx)(Z.Z,{component:V.Z,sx:{mt:2},children:(0,i.jsxs)(f.Z,{children:[(0,i.jsx)(p.Z,{children:(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(D.Z,{children:"Monitoring Check"}),(0,i.jsx)(D.Z,{children:"Check Type"}),(0,i.jsx)(D.Z,{children:"Target URL"}),(0,i.jsx)(D.Z,{children:"Status"}),(0,i.jsx)(D.Z,{children:"Linked Service"}),(0,i.jsx)(D.Z,{align:"center",children:"Actions"})]})}),(0,i.jsx)(y.Z,{children:n.map(e=>{var t;return(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(D.Z,{children:(0,i.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,i.jsx)(q.Z,{sx:{mr:1,color:"primary.main"}}),e.monitoring_check_name]})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(k.Z,{label:(null===(t=e.check_type)||void 0===t?void 0:t.toUpperCase())||"HTTP",size:"small",variant:"outlined"})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:e.target_url})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(k.Z,{label:"active"===e.status?"Active":"Inactive",color:"active"===e.status?"success":"default",size:"small"})}),(0,i.jsx)(D.Z,{children:e.linked_service_id?(0,i.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,i.jsx)(K,{sx:{mr:1,color:"secondary.main"}}),(0,i.jsx)(l.Z,{variant:"body2",children:e.linked_service_name})]}):(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",fontStyle:"italic",children:"Not linked"})}),(0,i.jsx)(D.Z,{align:"center",children:e.linked_service_id?(0,i.jsx)(a.Z,{title:"Remove association",children:(0,i.jsx)(c.Z,{size:"small",onClick:()=>ee(e.monitoring_check_id),color:"error",children:(0,i.jsx)(Q,{})})}):(0,i.jsx)(a.Z,{title:"Create association",children:(0,i.jsx)(c.Z,{size:"small",onClick:()=>{L(e.monitoring_check_id),P(!0)},color:"primary",children:(0,i.jsx)(G.Z,{})})})})]},e.monitoring_check_id)})})]})})]})}),(0,i.jsxs)(b.Z,{open:O,onClose:()=>P(!1),maxWidth:"sm",fullWidth:!0,children:[(0,i.jsx)(_.Z,{children:"Create Monitoring Association"}),(0,i.jsx)(S.Z,{children:(0,i.jsxs)(s.Z,{pt:1,children:[(0,i.jsxs)(U.Z,{fullWidth:!0,margin:"normal",children:[(0,i.jsx)(J.Z,{children:"Monitoring Check"}),(0,i.jsx)(Y.Z,{value:B,onChange:e=>L(e.target.value),label:"Monitoring Check",children:en().map(e=>{var t;return(0,i.jsx)(C.Z,{value:e.monitoring_check_id,children:(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(l.Z,{variant:"body2",children:e.monitoring_check_name}),(0,i.jsxs)(l.Z,{variant:"caption",color:"text.secondary",children:[null===(t=e.check_type)||void 0===t?void 0:t.toUpperCase()," - ",e.target_url]})]})},e.monitoring_check_id)})})]}),(0,i.jsxs)(U.Z,{fullWidth:!0,margin:"normal",children:[(0,i.jsx)(J.Z,{children:"Status Page Service (Optional)"}),(0,i.jsxs)(Y.Z,{value:N,onChange:e=>R(e.target.value),label:"Status Page Service (Optional)",children:[(0,i.jsx)(C.Z,{value:"",children:(0,i.jsx)("em",{children:"No service (remove association)"})}),h.map(e=>(0,i.jsx)(C.Z,{value:e.id,children:(0,i.jsxs)(s.Z,{display:"flex",alignItems:"center",width:"100%",children:[(0,i.jsxs)(s.Z,{flexGrow:1,children:[(0,i.jsx)(l.Z,{variant:"body2",children:e.name}),e.description&&(0,i.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:e.description})]}),(0,i.jsx)(k.Z,{label:e.status||"operational",color:et(e.status),size:"small",sx:{ml:1}})]})},e.id))]})]}),(0,i.jsx)(j.Z,{severity:"info",sx:{mt:2},children:"When the monitoring check fails, the linked service status will automatically update to reflect the issue. When the check recovers, the service status will return to operational."})]})}),(0,i.jsxs)(z.Z,{children:[(0,i.jsx)(d.Z,{onClick:()=>P(!1),disabled:W,children:"Cancel"}),(0,i.jsx)(d.Z,{onClick:$,variant:"contained",disabled:W||!B,startIcon:W?(0,i.jsx)(r.Z,{size:20}):(0,i.jsx)(G.Z,{}),children:W?"Creating...":"Create Association"})]})]})]})},$=n(99376),ee=n(85744);function et(){var e;let[t,n]=(0,o.useState)([]),[N,V]=(0,o.useState)([]),[U,J]=(0,o.useState)(!0),[Y,G]=(0,o.useState)(null),[q,K]=(0,o.useState)(!1),[Q,et]=(0,o.useState)(null),[en,ei]=(0,o.useState)(null),[eo,er]=(0,o.useState)(null),[es,el]=(0,o.useState)(!1),[ea,ec]=(0,o.useState)(null),[ed,eu]=(0,o.useState)(null),[eh,eg]=(0,o.useState)(!1),[ex,em]=(0,o.useState)(0),{session:ej,selectedOrganization:eZ}=(0,H.o)(),ef=(0,$.useRouter)();(0,o.useEffect)(()=>{eg(!0)},[]),(0,o.useEffect)(()=>{ej&&ep()},[ej,eZ]),(0,o.useEffect)(()=>{if(!ej)return;let e=setInterval(()=>{ep()},3e4);return()=>clearInterval(e)},[ej,eZ]),(0,o.useEffect)(()=>{if(!ej||!eZ)return;let e=async()=>{try{let e=await fetch("/api/monitoring/cron");if(e.ok){let t=await e.json();console.log("Auto-execution result:",t),t.summary&&t.summary.executed>0&&setTimeout(()=>{ep()},2e3)}}catch(e){console.error("Auto-execution error:",e)}},n=t.filter(e=>"pending"===e.current_status||"unknown"===e.current_status);n.length>0&&(console.log("Found ".concat(n.length," pending checks, triggering auto-execution...")),e());let i=setInterval(e,12e4);return()=>clearInterval(i)},[ej,eZ,t]),(0,o.useEffect)(()=>{console.log("\uD83D\uDD0D deleteDialogOpen changed:",es)},[es]),(0,o.useEffect)(()=>{console.log("\uD83D\uDD0D deletingCheckId changed:",ea)},[ea]),(0,o.useEffect)(()=>{console.log("\uD83D\uDD0D selectedCheck changed:",null==eo?void 0:eo.id,null==eo?void 0:eo.name)},[eo]);let ep=async()=>{try{J(!0),G(null);let e=new URLSearchParams;(null==eZ?void 0:eZ.id)&&e.append("organization_id",eZ.id),console.log("Fetching monitoring data with params:",e.toString()),console.log("Selected organization:",eZ);let t=await fetch("/api/monitoring?".concat(e.toString()));if(!t.ok)throw Error("Failed to fetch monitoring checks");let i=await t.json();console.log("Monitoring API response:",i),n(i.monitoring_checks||[]),console.log("Set monitoring checks:",i.monitoring_checks||[]);let o=new URLSearchParams;(null==eZ?void 0:eZ.id)&&o.append("organization_id",eZ.id),o.append("status","open"),o.append("status","investigating"),o.append("status","identified"),o.append("status","monitoring");let r=await fetch("/api/incidents?".concat(o.toString()));if(r.ok){let e=await r.json();V(e.incidents||[])}else V([])}catch(e){console.error("Error fetching monitoring data:",e),G(e.message)}finally{J(!1)}},ev=async e=>{try{et(e),G(null);let t=await fetch("/api/monitoring/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checkId:e,organizationId:null==eZ?void 0:eZ.id})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to execute check")}let n=await t.json();console.log("Check execution result:",n),await ep(),G(null)}catch(e){console.error("Error executing check:",e),G("Failed to execute check: ".concat(e.message))}finally{et(null)}},eD=async()=>{if(!(null==eZ?void 0:eZ.id)){G("Please select an organization");return}try{K(!0),G(null);let e=await fetch("/api/monitoring/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({executeAll:!0,organizationId:eZ.id})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to execute checks")}let t=await e.json();console.log("Bulk execution result:",t),await ep(),G(null)}catch(e){console.error("Error executing checks:",e),G("Failed to execute checks: ".concat(e.message))}finally{K(!1)}},ey=(e,t)=>{console.log("\uD83D\uDD17 Menu opened for check:",null==t?void 0:t.id,null==t?void 0:t.name),ei(e.currentTarget),er(t),console.log("\uD83D\uDD17 Set selectedCheck to:",t)},ek=()=>{ei(null),er(null)},ew=async()=>{if(eo)try{eu(eo.id),G(null);let e=await fetch("/api/monitoring/".concat(eo.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:!eo.is_active})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to update monitoring check")}await ep(),ek()}catch(e){console.error("Error updating monitoring check:",e),G("Failed to update check: ".concat(e.message))}finally{eu(null)}},eC=async()=>{if(console.log("\uD83C\uDFAF handleDeleteCheck called"),console.log("\uD83C\uDFAF selectedCheck:",eo),console.log("\uD83C\uDFAF deleteDialogOpen:",es),!eo){console.error("❌ No check selected for deletion");return}console.log("\uD83D\uDDD1️ Starting delete process for check:",eo.id,eo.name);try{ec(eo.id),G(null),console.log("\uD83D\uDCE1 Making DELETE request to:","/api/monitoring/".concat(eo.id));let e=await fetch("/api/monitoring/".concat(eo.id),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(console.log("\uD83D\uDCE1 Response status:",e.status,e.statusText),!e.ok){let t;try{t=await e.json()}catch(n){console.error("Failed to parse error response:",n),t={error:"HTTP ".concat(e.status,": ").concat(e.statusText)}}throw console.error("❌ Delete failed:",t),Error(t.error||"Failed to delete monitoring check")}let t=await e.json();console.log("✅ Delete successful:",t),console.log("\uD83D\uDD04 Refreshing monitoring data..."),await ep(),console.log("\uD83D\uDD12 Closing dialog and clearing selected check..."),el(!1),er(null),ei(null),console.log("✅ Delete process completed successfully")}catch(e){console.error("❌ Error deleting monitoring check:",e),G("Failed to delete check: ".concat(e.message))}finally{console.log("\uD83C\uDFC1 Clearing deleting state"),ec(null)}},eb=async()=>{eo&&(ek(),await ev(eo.id))},e_=()=>{if(console.log("\uD83D\uDD13 Opening delete dialog"),console.log("\uD83D\uDD13 Selected check:",eo),console.log("\uD83D\uDD13 Current deleteDialogOpen state:",es),!eo){console.error("❌ Cannot open delete dialog: no check selected");return}el(!0),console.log("\uD83D\uDD13 Set deleteDialogOpen to true"),ei(null)},eS=e=>{switch(e){case"up":return(0,i.jsx)(F.Z,{color:"success"});case"down":return(0,i.jsx)(M.Z,{color:"error"});case"warning":return(0,i.jsx)(T.Z,{color:"warning"});case"inactive":return(0,i.jsx)(L.Z,{color:"disabled"});case"pending":return(0,i.jsx)(r.Z,{size:20,color:"info"});default:return(0,i.jsx)(T.Z,{color:"disabled"})}},ez=e=>{switch(e){case"up":return"success";case"down":return"error";case"warning":return"warning";case"inactive":case"unknown":default:return"default";case"pending":return"info"}},eE=e=>{switch(e){case"http":return"primary";case"ping":return"secondary";case"tcp":return"info";case"ssl":return"warning";default:return"default"}},eI=e=>e?e<1e3?"".concat(e,"ms"):"".concat((e/1e3).toFixed(2),"s"):"N/A",eA=(e,t)=>{if(!t)return"Paused";if(!e)return"Unknown";if(!eh)return"Loading...";let n=new Date,o=new Date(e),r=o.getTime()-n.getTime();return r<3e4?(0,i.jsx)("span",{style:{color:"#ff9800"},children:r<0?"Overdue":"Now"}):r<36e5?"in ".concat(Math.floor(r/6e4),"m"):r<864e5?"in ".concat(Math.floor(r/36e5),"h ").concat(Math.floor(r%36e5/6e4),"m"):o.toLocaleString()},eF={total:t.length||0,up:t.filter(e=>(null==e?void 0:e.current_status)==="up").length||0,down:t.filter(e=>(null==e?void 0:e.current_status)==="down").length||0,warning:t.filter(e=>(null==e?void 0:e.current_status)==="warning").length||0,inactive:t.filter(e=>(null==e?void 0:e.current_status)==="inactive").length||0};return(0,i.jsx)(ee.Z,{children:(0,i.jsxs)(s.Z,{sx:{p:3},children:[(0,i.jsxs)(s.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,children:[(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(l.Z,{variant:"h4",component:"h1",gutterBottom:!0,children:"Monitoring"}),(0,i.jsx)(l.Z,{variant:"body1",color:"text.secondary",children:"Monitor your services and infrastructure health"})]}),(0,i.jsxs)(s.Z,{display:"flex",gap:2,alignItems:"center",children:[(0,i.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:"Auto-refreshes every 30s"}),(0,i.jsx)(a.Z,{title:"Refresh",children:(0,i.jsx)(c.Z,{onClick:ep,color:"primary",children:(0,i.jsx)(A.Z,{})})}),(0,i.jsx)(a.Z,{title:"Execute All Checks",children:(0,i.jsx)(c.Z,{onClick:eD,color:"success",disabled:q||!eZ,children:(0,i.jsx)(O.Z,{})})}),(0,i.jsx)(d.Z,{component:E.default,href:"/monitoring/new",variant:"contained",startIcon:(0,i.jsx)(I.Z,{}),color:"primary",children:"Add Monitor"})]})]}),(0,i.jsx)(s.Z,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,i.jsxs)(u.Z,{value:ex,onChange:(e,t)=>em(t),children:[(0,i.jsx)(h.Z,{label:"Monitoring Checks"}),(0,i.jsx)(h.Z,{label:"Service Associations"})]})}),0===ex?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(g.Z,{container:!0,spacing:3,sx:{mb:4},children:[(0,i.jsx)(g.Z,{item:!0,xs:12,md:2.4,children:(0,i.jsx)(x.Z,{children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(l.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Total Monitors"}),(0,i.jsx)(l.Z,{variant:"h3",color:"primary",children:eF.total})]})})}),(0,i.jsx)(g.Z,{item:!0,xs:12,md:2.4,children:(0,i.jsx)(x.Z,{children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(l.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Up"}),(0,i.jsx)(l.Z,{variant:"h3",color:"success.main",children:eF.up})]})})}),(0,i.jsx)(g.Z,{item:!0,xs:12,md:2.4,children:(0,i.jsx)(x.Z,{children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(l.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Down"}),(0,i.jsx)(l.Z,{variant:"h3",color:"error.main",children:eF.down})]})})}),(0,i.jsx)(g.Z,{item:!0,xs:12,md:2.4,children:(0,i.jsx)(x.Z,{children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(l.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Warning"}),(0,i.jsx)(l.Z,{variant:"h3",color:"warning.main",children:eF.warning})]})})}),(0,i.jsx)(g.Z,{item:!0,xs:12,md:2.4,children:(0,i.jsx)(x.Z,{component:E.default,href:"/incidents",sx:{textDecoration:"none",cursor:"pointer","&:hover":{backgroundColor:"action.hover",transform:"translateY(-1px)",boxShadow:2},transition:"all 0.2s ease-in-out"},children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(l.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Active Incidents"}),(0,i.jsx)(l.Z,{variant:"h3",color:N.length>0?"error.main":"success.main",children:N.length}),(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:"Click to view details"})]})})})]}),Y&&(0,i.jsx)(j.Z,{severity:"error",sx:{mb:2},children:Y}),(0,i.jsx)(x.Z,{children:(0,i.jsx)(m.Z,{sx:{p:0},children:U?(0,i.jsx)(s.Z,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:(0,i.jsx)(r.Z,{})}):0===t.length?(0,i.jsxs)(s.Z,{textAlign:"center",py:6,children:[(0,i.jsx)(l.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No monitoring checks found"}),(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",mb:3,children:"Add your first monitoring check to start tracking service health."}),(0,i.jsx)(d.Z,{component:E.default,href:"/monitoring/new",variant:"contained",startIcon:(0,i.jsx)(I.Z,{}),color:"primary",children:"Add Monitor"})]}):(0,i.jsx)(Z.Z,{children:(0,i.jsxs)(f.Z,{children:[(0,i.jsx)(p.Z,{children:(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(D.Z,{children:"Status"}),(0,i.jsx)(D.Z,{children:"Name"}),(0,i.jsx)(D.Z,{children:"Type"}),(0,i.jsx)(D.Z,{children:"Target"}),(0,i.jsx)(D.Z,{children:"SSL Certificate"}),(0,i.jsx)(D.Z,{children:"Location"}),(0,i.jsx)(D.Z,{children:"Response Time"}),(0,i.jsx)(D.Z,{children:"Last Check"}),(0,i.jsx)(D.Z,{children:"Next Check"}),(0,i.jsx)(D.Z,{children:"Organization"}),(0,i.jsx)(D.Z,{children:"Actions"})]})}),(0,i.jsx)(y.Z,{children:t.map(e=>(0,i.jsxs)(v.Z,{hover:!0,children:[(0,i.jsx)(D.Z,{children:(0,i.jsxs)(s.Z,{display:"flex",alignItems:"center",gap:1,children:[eS(e.current_status),(0,i.jsx)(k.Z,{label:e.current_status||"Unknown",color:ez(e.current_status),size:"small"})]})}),(0,i.jsxs)(D.Z,{children:[(0,i.jsx)(l.Z,{variant:"subtitle2",fontWeight:"medium",children:e.name}),!e.is_active&&(0,i.jsx)(k.Z,{label:"Inactive",size:"small",variant:"outlined"})]}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(k.Z,{label:e.check_type.toUpperCase(),color:eE(e.check_type),size:"small",variant:"outlined"})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(l.Z,{variant:"body2",sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:e.target_url})}),(0,i.jsx)(D.Z,{children:e.ssl_check_enabled?(0,i.jsxs)(s.Z,{display:"flex",alignItems:"center",gap:1,children:[(0,i.jsx)(k.Z,{label:"valid"===e.ssl_status?"Valid":"expired"===e.ssl_status?"Expired":"expiring"===e.ssl_status?"Expiring Soon":"Pending",color:"valid"===e.ssl_status?"success":"expired"===e.ssl_status?"error":"expiring"===e.ssl_status?"warning":"default",size:"small",variant:"outlined"}),null!==e.ssl_days_until_expiry&&(0,i.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:e.ssl_days_until_expiry>0?"".concat(e.ssl_days_until_expiry,"d"):"Expired"})]}):(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:"Disabled"})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(l.Z,{variant:"body2",children:e.location_name||"Default"})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(l.Z,{variant:"body2",children:eI(e.last_response_time)})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(l.Z,{variant:"body2",children:e.last_check_time?new Date(e.last_check_time).toLocaleString():"Never"})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(l.Z,{variant:"body2",color:"Now"===eA(e.next_check_time,e.is_active)?"warning.main":"text.secondary",children:eA(e.next_check_time,e.is_active)})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(l.Z,{variant:"body2",children:e.organization_name})}),(0,i.jsx)(D.Z,{children:(0,i.jsx)(c.Z,{onClick:t=>{console.log("\uD83D\uDD17 Actions button clicked for check:",e.id,e.name),ey(t,e)},size:"small",disabled:Q===e.id||ed===e.id||ea===e.id,children:Q===e.id||ed===e.id||ea===e.id?(0,i.jsx)(r.Z,{size:16}):(0,i.jsx)(P.Z,{})})})]},e.id))})]})})})}),(0,i.jsxs)(w.Z,{anchorEl:en,open:!!en,onClose:ek,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[(0,i.jsxs)(C.Z,{onClick:eb,children:[(0,i.jsx)(O.Z,{sx:{mr:1}}),"Run Check Now"]}),(0,i.jsx)(C.Z,{onClick:ew,children:(null==eo?void 0:eo.is_active)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L.Z,{sx:{mr:1}}),"Disable"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R,{sx:{mr:1}}),"Enable"]})}),(0,i.jsxs)(C.Z,{onClick:()=>{eo&&(ek(),ef.push("/monitoring/edit/".concat(eo.id)))},children:[(0,i.jsx)(W.Z,{sx:{mr:1}}),"Edit"]}),(0,i.jsxs)(C.Z,{onClick:e=>{console.log("\uD83D\uDDB1️ Delete menu item clicked"),console.log("\uD83D\uDDB1️ Event:",e),console.log("\uD83D\uDDB1️ selectedCheck:",eo),e_()},sx:{color:"error.main"},children:[(0,i.jsx)(B.Z,{sx:{mr:1}}),"Delete"]})]}),(0,i.jsxs)(b.Z,{open:es,onClose:()=>{console.log("\uD83D\uDD12 Dialog onClose triggered"),console.log("\uD83D\uDD12 Current deleteDialogOpen state:",es),el(!1),er(null),console.log("\uD83D\uDD12 Dialog closed and selectedCheck cleared")},"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",maxWidth:"sm",fullWidth:!0,children:[(0,i.jsxs)(_.Z,{id:"delete-dialog-title",sx:{display:"flex",alignItems:"center",gap:2,pb:1},children:[(0,i.jsx)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:48,height:48,borderRadius:"50%",backgroundColor:"error.light",color:"error.contrastText"},children:(0,i.jsx)(B.Z,{})}),(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(l.Z,{variant:"h6",component:"div",children:"Delete Monitoring Check"}),(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:"This action cannot be undone"})]})]}),(0,i.jsxs)(S.Z,{sx:{pt:2},children:[(0,i.jsxs)(s.Z,{sx:{mb:2},children:[(0,i.jsx)(l.Z,{variant:"body1",gutterBottom:!0,children:"Are you sure you want to delete this monitoring check?"}),eo&&(0,i.jsxs)(s.Z,{sx:{mt:2,p:2,backgroundColor:"grey.50",borderRadius:1,border:"1px solid",borderColor:"grey.200"},children:[(0,i.jsx)(l.Z,{variant:"subtitle2",fontWeight:"medium",gutterBottom:!0,children:eo.name}),(0,i.jsx)(l.Z,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:eo.target_url}),(0,i.jsxs)(s.Z,{sx:{display:"flex",gap:1,mt:1},children:[(0,i.jsx)(k.Z,{label:null===(e=eo.check_type)||void 0===e?void 0:e.toUpperCase(),size:"small",variant:"outlined",color:"primary"}),(0,i.jsx)(k.Z,{label:eo.current_status||"Unknown",size:"small",color:ez(eo.current_status)})]})]})]}),(0,i.jsx)(j.Z,{severity:"warning",sx:{mt:2},children:(0,i.jsx)(l.Z,{variant:"body2",children:"This will permanently remove the monitoring check and all associated historical data, including check results and incident records."})})]}),(0,i.jsxs)(z.Z,{sx:{px:3,pb:3,pt:1,gap:1},children:[(0,i.jsx)(d.Z,{onClick:()=>{console.log("❌ Cancel button clicked"),el(!1),er(null),console.log("❌ Dialog cancelled and selectedCheck cleared")},disabled:ea===(null==eo?void 0:eo.id),variant:"outlined",size:"large",sx:{minWidth:100},children:"Cancel"}),(0,i.jsx)(d.Z,{onClick:e=>{console.log("\uD83D\uDDB1️ Delete button clicked"),console.log("\uD83D\uDD0D Event:",e),console.log("\uD83D\uDD0D Current selectedCheck:",eo),console.log("\uD83D\uDD0D Current deletingCheckId:",ea),console.log("\uD83D\uDD0D Delete dialog open:",es);try{eC()}catch(e){console.error("\uD83D\uDD25 Error in delete handler:",e)}},color:"error",variant:"contained",disabled:ea===(null==eo?void 0:eo.id),startIcon:ea===(null==eo?void 0:eo.id)?(0,i.jsx)(r.Z,{size:16,color:"inherit"}):(0,i.jsx)(B.Z,{}),size:"large",sx:{minWidth:120},children:ea===(null==eo?void 0:eo.id)?"Deleting...":"Delete Check"})]})]})]}):eZ?(0,i.jsx)(X,{organizationId:eZ.id}):(0,i.jsx)(j.Z,{severity:"info",children:"Please select an organization from the navbar to view service associations."})]})})}},85744:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(57437),o=n(2265),r=n(8319),s=n(38543),l=n(44812);function a(e){let{children:t}=e,{session:n,sessionStatus:a}=(0,l.o)();return((0,o.useEffect)(()=>{"unauthenticated"===a&&(window.location.href="/api/auth/signin")},[a]),"loading"===a)?(0,i.jsx)(s.Z,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:(0,i.jsx)(r.Z,{})}):n?t:null}},44812:function(e,t,n){"use strict";n.d(t,{f:function(){return a},o:function(){return c}});var i=n(57437),o=n(2265);let r=(0,o.createContext)(),s=()=>{try{if(window.localStorage)return localStorage.getItem("selectedOrganizationId")}catch(e){console.warn("Failed to read from localStorage:",e)}return null},l=e=>{try{if(window.localStorage){if(e)return localStorage.setItem("selectedOrganizationId",e),console.log("✅ Saved to localStorage:",e),!0;return localStorage.removeItem("selectedOrganizationId"),console.log("\uD83D\uDDD1️ Removed from localStorage"),!0}}catch(e){console.warn("Failed to write to localStorage:",e)}return!1};function a(e){let{children:t}=e,{data:n,status:a}=function(){let[e,t]=(0,o.useState)(null),[n,i]=(0,o.useState)("loading");return(0,o.useEffect)(()=>{let e=async()=>{try{i("loading");let e=await fetch("/api/auth/session");if(e.ok){let n=await e.json();t(n),i(n?"authenticated":"unauthenticated")}else t(null),i("unauthenticated")}catch(e){console.error("Error fetching session:",e),t(null),i("unauthenticated")}};e();let n=setInterval(e,3e5);return()=>clearInterval(n)},[]),{data:e,status:n}}(),[c,d]=(0,o.useState)(null),[u,h]=(0,o.useState)([]),[g,x]=(0,o.useState)(!1),[m,j]=(0,o.useState)(null),[Z,f]=(0,o.useState)(!1);(0,o.useEffect)(()=>{f(!0)},[]),(0,o.useEffect)(()=>{if(Z&&u.length>0&&!c){console.log("\uD83D\uDD0D Client-side restoration check...");let e=s();if(e){let t=u.find(t=>t.id===e);t?(console.log("\uD83D\uDD04 Client-side restoration successful:",t.name),d(t)):(console.log("⚠️ Saved organization no longer available, clearing storage"),l(null))}}},[Z,u,c]),(0,o.useEffect)(()=>{var e;console.log("\uD83D\uDD04 OrganizationContext:",(null==n?void 0:null===(e=n.user)||void 0===e?void 0:e.email)||"no session","[".concat(a,"]")),n&&"authenticated"===a?p():"unauthenticated"===a&&(console.log("\uD83D\uDEAA User logged out - clearing organizations"),h([]),d(null),l(null))},[n,a]);let p=async()=>{try{x(!0),j(null);let e=await fetch("/api/organizations");if(e.ok){let t=(await e.json()).organizations||[];h(t);let n=null,i=s();if(console.log("\uD83D\uDD0D Checking localStorage for saved organization:",i),i&&((n=t.find(e=>e.id===i))?console.log("\uD83C\uDFAF Found matching organization for restoration:",n.name):(console.log("⚠️ Saved organization ID not found in current organizations, clearing localStorage"),l(null))),!n&&t.length>1){console.log("\uD83D\uDD0D Checking for default organization...");try{let e=await fetch("/api/user/default-organization");if(e.ok){let i=await e.json();if(i.hasDefault){let e=t.find(e=>e.id===i.defaultOrganization.id);e&&(n=e,console.log("⭐ Found default organization:",e.name))}}}catch(e){console.error("Error fetching default organization:",e)}}if(n)console.log("✅ Selected organization:",n.name),d(n),l(n.id);else if(1===t.length){let e=t[0];console.log("\uD83D\uDD04 Auto-selecting single organization:",e.name),d(e),l(e.id)}else 0===t.length?(console.log("\uD83D\uDCED No organizations available"),d(null)):console.log("\uD83E\uDD14 Multiple organizations available, waiting for user selection")}else console.error("Failed to fetch organizations:",e.status,e.statusText),j("Failed to fetch organizations"),h([])}catch(e){console.error("Error fetching organizations:",e),j(e.message),h([])}finally{x(!1)}};return(0,i.jsx)(r.Provider,{value:{selectedOrganization:c,organizations:u,loading:g,error:m,selectOrganization:e=>{console.log("\uD83D\uDCBE Selecting organization:",(null==e?void 0:e.name)||"none"),d(e),l((null==e?void 0:e.id)||null)},refreshOrganizations:p,session:n,sessionStatus:a},children:t})}function c(){let e=(0,o.useContext)(r);if(void 0===e)throw Error("useOrganization must be used within an OrganizationProvider");return e}},99376:function(e,t,n){"use strict";var i=n(35475);n.o(i,"notFound")&&n.d(t,{notFound:function(){return i.notFound}}),n.o(i,"useParams")&&n.d(t,{useParams:function(){return i.useParams}}),n.o(i,"usePathname")&&n.d(t,{usePathname:function(){return i.usePathname}}),n.o(i,"useRouter")&&n.d(t,{useRouter:function(){return i.useRouter}}),n.o(i,"useSearchParams")&&n.d(t,{useSearchParams:function(){return i.useSearchParams}})},12961:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle")},67731:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error")},4568:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"}),"Link")},59700:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M20 3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h3l-1 1v2h12v-2l-1-1h3c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 13H4V5h16z"}),"Monitor")},19391:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert")},89010:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause")},40196:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow")},37306:function(e,t,n){"use strict";var i=n(64059),o=n(57437);t.Z=(0,i.Z)((0,o.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning")},73985:function(e,t,n){"use strict";var i=n(2265),o=n(61994),r=n(7609),s=n(90658),l=n(1589),a=n(42318),c=n(51864),d=n(70708),u=n(57437);let h=e=>{let{classes:t}=e;return(0,r.Z)({root:["root"]},c.a,t)},g=(0,l.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),x=i.forwardRef(function(e,t){let n=(0,a.i)({props:e,name:"MuiDialogTitle"}),{className:r,id:s,...l}=n,c=h(n),{titleId:x=s}=i.useContext(d.Z);return(0,u.jsx)(g,{component:"h2",className:(0,o.Z)(c.root,r),ownerState:n,ref:t,variant:"h6",id:null!=s?s:x,...l})});t.Z=x}},function(e){e.O(0,[702,7639,7863,3744,793,9352,8129,7286,4045,8150,2982,6043,2971,7466,1744],function(){return e(e.s=86611)}),_N_E=e.O()}]);