var J=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var Y=Object.prototype.hasOwnProperty;var Z=(c,p)=>()=>(c&&(p=c(c=0)),p);var B=(c,p,N,f)=>{if(p&&typeof p=="object"||typeof p=="function")for(let m of V(p))!Y.call(c,m)&&m!==N&&J(c,m,{get:()=>p[m],enumerable:!(f=Q(p,m))||f.enumerable});return c},W=(c,p,N)=>(B(c,p,"default"),N&&B(N,p,"default"));var ee=c=>B(J({},"__esModule",{value:!0}),c);var M={};import*as gt from"async_hooks";var X=Z(()=>{W(M,gt)});import{__getNamedExports as te}from"../../../__next-on-pages-dist__/webpack/ac7e0cd817c0f96ac6506045b651299a.js";import{__getNamedExports as ne}from"../../../__next-on-pages-dist__/webpack/fc1dd92f63cefab5577162dd844679df.js";import{__getNamedExports as ae}from"../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var v=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/test-http-db"),s=te(v,v,v),re=s.__chunk_6195,se=s.__chunk_2067,oe=s.__chunk_9182,ie=s.__chunk_8983,_e=s.__chunk_5228,ce=s.__chunk_2296,ue=s.__chunk_2594,pe=s.__chunk_6735,de=s.__chunk_8219,ge=s.__chunk_5577,he=s.__chunk_9254,le=s.__chunk_9206,xe=s.__chunk_989,ke=s.__chunk_1863,fe=s.__chunk_3039,me=s.__chunk_335,ye=s.__chunk_8042,be=s.__chunk_7765,Pe=s.__chunk_6991,ve=s.__chunk_8816,we=s.__chunk_6631,Ee=s.__chunk_4828,Re=s.__chunk_4834,$e=s.__chunk_828,Te=s.__chunk_5927,Oe=s.__chunk_8439,Ae=s.__chunk_4363,Se=s.__chunk_2039,Ne=s.__chunk_8264,je=s.__chunk_1583,Ce=s.__chunk_7908,Ke=s.__chunk_8949,Ie=s.__chunk_796,Me=s.__chunk_1651,Le=s.__chunk_5105,De=s.__chunk_9642,Fe=s.__chunk_5028,Ue=s.__chunk_9548,He=s.__chunk_6914,qe=s.__chunk_7960,Be=s.__chunk_4337,We=s.__chunk_8819,l=ne(v,v,v),ze=l.__chunk_1730,Je=l.__chunk_3818,Xe=l.__chunk_7037,Ge=l.__chunk_9573,Qe=l.__chunk_7701,Ve=l.__chunk_662,Ye=l.__chunk_4101,Ze=l.__chunk_6776,et=l.__chunk_3665,tt=l.__chunk_7444,nt=l.__chunk_4591,at=l.__chunk_7983,rt=l.__chunk_581,st=l.__chunk_2561,ot=l.__chunk_2988,it=l.__chunk_6947,_t=l.__chunk_5996,ct=l.__chunk_676,G=ae(v,v,v),ut=G.__NEXT_FONT_MANIFEST,pt=G.__REACT_LOADABLE_MANIFEST,kt=((c,p,N)=>(p._ENTRIES={},c.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/fd9d1056-30de07f4a3c346ee.js","static/chunks/7466-8fdf295a7c02cf2e.js","static/chunks/main-app-8eaf6dc4ad0df15d.js"],pages:{"/_app":["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/framework-8e0e0f4a6b83a956.js","static/chunks/main-17007a384daea84e.js","static/chunks/pages/_app-3c9ca398d360b709.js"],"/_error":["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/framework-8e0e0f4a6b83a956.js","static/chunks/main-17007a384daea84e.js","static/chunks/pages/_error-cf5ca766ac8f493f.js"]},ampFirstPages:[]},c.__BUILD_MANIFEST.lowPriorityFiles=["/static/5vAXtrh2qjJDoCjPjRb93/_buildManifest.js",,"/static/5vAXtrh2qjJDoCjPjRb93/_ssgManifest.js"],c.__REACT_LOADABLE_MANIFEST=pt,c.__NEXT_FONT_MANIFEST=ut,c.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var f={},m={};function i(t){var _=m[t];if(_!==void 0)return _.exports;var r=m[t]={exports:{}},d=!0;try{f[t].call(r.exports,r,r.exports,i),d=!1}finally{d&&delete m[t]}return r.exports}i.m=f,i.amdO={},(()=>{var t=[];i.O=(_,r,d,h)=>{if(r){h=h||0;for(var u=t.length;u>0&&t[u-1][2]>h;u--)t[u]=t[u-1];t[u]=[r,d,h];return}for(var g=1/0,u=0;u<t.length;u++){for(var[r,d,h]=t[u],y=!0,P=0;P<r.length;P++)g>=h&&Object.keys(i.O).every(S=>i.O[S](r[P]))?r.splice(P--,1):(y=!1,h<g&&(g=h));if(y){t.splice(u--,1);var w=d();w!==void 0&&(_=w)}}return _}})(),i.n=t=>{var _=t&&t.__esModule?()=>t.default:()=>t;return i.d(_,{a:_}),_},(()=>{var t,_=Object.getPrototypeOf?r=>Object.getPrototypeOf(r):r=>r.__proto__;i.t=function(r,d){if(1&d&&(r=this(r)),8&d||typeof r=="object"&&r&&(4&d&&r.__esModule||16&d&&typeof r.then=="function"))return r;var h=Object.create(null);i.r(h);var u={};t=t||[null,_({}),_([]),_(_)];for(var g=2&d&&r;typeof g=="object"&&!~t.indexOf(g);g=_(g))Object.getOwnPropertyNames(g).forEach(y=>u[y]=()=>r[y]);return u.default=()=>r,i.d(h,u),h}})(),i.d=(t,_)=>{for(var r in _)i.o(_,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:_[r]})},i.e=()=>Promise.resolve(),i.g=function(){if(typeof p=="object")return p;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),i.o=(t,_)=>Object.prototype.hasOwnProperty.call(t,_),i.r=t=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={5993:0};i.O.j=d=>t[d]===0;var _=(d,h)=>{var u,g,[y,P,w]=h,T=0;if(y.some(C=>t[C]!==0)){for(u in P)i.o(P,u)&&(i.m[u]=P[u]);if(w)var j=w(i)}for(d&&d(h);T<y.length;T++)g=y[T],i.o(t,g)&&t[g]&&t[g][0](),t[g]=0;return i.O(j)},r=c.webpackChunk_N_E=c.webpackChunk_N_E||[];r.forEach(_.bind(null,0)),r.push=_.bind(null,r.push.bind(r))})()})(),(c.webpackChunk_N_E=c.webpackChunk_N_E||[]).push([[2720],{8819:We,4337:Be,7960:qe,6914:He,9548:Ue,5028:Fe,9642:De,5105:Le,1651:Me,796:Ie,8949:Ke,7908:Ce,1583:je,8264:Ne,2039:Se,4363:Ae,8439:Oe,5927:Te,828:$e,4834:Re,4828:Ee,6631:we,8816:ve,6991:Pe,7765:be,8042:ye,335:me,3039:fe,1863:ke,989:xe,9206:le,9254:he,5577:ge,8219:de,6735:pe,2594:ue,2296:ce,5228:_e,8983:ie,9182:oe}]),(c.webpackChunk_N_E=c.webpackChunk_N_E||[]).push([[7883],{676:ct,5996:_t,6947:it,2988:ot,2561:st,581:rt,7983:at,4591:nt,7444:tt,3665:et,6776:Ze,4101:Ye,662:Ve,7701:Qe,9573:Ge,7037:Xe,3818:Je,1730:ze}]),(c.webpackChunk_N_E=c.webpackChunk_N_E||[]).push([[8082],{2067:se,6195:re,3241:(f,m,i)=>{"use strict";i.r(m),i.d(m,{ComponentMod:()=>F,default:()=>E});var t={};i.r(t),i.d(t,{GET:()=>S,POST:()=>U,runtime:()=>K});var _={};i.r(_),i.d(_,{originalPathname:()=>q,patchFetch:()=>O,requestAsyncStorage:()=>H,routeModule:()=>I,serverHooks:()=>D,staticGenerationAsyncStorage:()=>L});var r=i(7983),d=i(2561),h=i(4828),u=i(6631);let g=process.env.JWT_SECRET||process.env.DATABASE_JWT_SECRET,y=process.env.HTTP_DATABASE_URL;async function P(e={}){if(!g)throw Error("JWT_SECRET environment variable is required");let o={role:"authenticated",iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+3600,...e},a=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/[=+/]/g,b=>({"=":"","+":"-","/":"_"})[b]),n=btoa(JSON.stringify(o)).replace(/[=+/]/g,b=>({"=":"","+":"-","/":"_"})[b]),k=`${a}.${n}`,x=await crypto.subtle.importKey("raw",new TextEncoder().encode(g),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),R=btoa(String.fromCharCode(...new Uint8Array(await crypto.subtle.sign("HMAC",x,new TextEncoder().encode(k))))).replace(/[=+/]/g,b=>({"=":"","+":"-","/":"_"})[b]);return`${k}.${R}`}async function w(e,o=[]){if(!y)throw Error("HTTP_DATABASE_URL environment variable is required");try{let a=await P(),n=await fetch(`${y}/rpc/execute_sql`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,Accept:"application/json"},body:JSON.stringify({query:e,params:o})});if(!n.ok){let x=await n.text();throw Error(`HTTP ${n.status}: ${x}`)}let k=await n.json();return{rows:k.data||k.rows||k}}catch(a){throw console.error("HTTP Database query error:",a),a}}async function T(e,o=[]){return await w(e,o)}async function j(){try{return(await w("SELECT 1 as test, NOW() as timestamp")).rows.length>0}catch(e){return console.error("Connection test failed:",e),!1}}async function C(){try{return{status:"healthy",...(await w(`
      SELECT 
        current_database() as database,
        current_user as user,
        version() as version,
        NOW() as timestamp
    `)).rows[0]}}catch(e){return{status:"unhealthy",error:e.message}}}let K="edge";async function S(){try{if(console.log("Testing HTTP database connection..."),!await j())return Response.json({success:!1,error:"Database connection failed"},{status:500});let e=await C(),o=await T("SELECT COUNT(*) as total_tables FROM information_schema.tables WHERE table_schema = $1",["alert24_schema"]);return Response.json({success:!0,message:"HTTP Database connection successful!",connection:{url:process.env.HTTP_DATABASE_URL,authenticated:!0,runtime:"edge"},health:e,test_query:o.rows[0],timestamp:new Date().toISOString()})}catch(e){return console.error("HTTP Database test error:",e),Response.json({success:!1,error:e.message,stack:void 0,connection:{url:process.env.HTTP_DATABASE_URL?"configured":"missing",jwt_secret:process.env.JWT_SECRET?"configured":"missing"}},{status:500})}}async function U(e){try{let{sql:o,params:a=[]}=await e.json();if(!o)return Response.json({success:!1,error:"SQL query is required"},{status:400});let n=await T(o,a);return Response.json({success:!0,result:n.rows,row_count:n.rows.length})}catch(o){return console.error("HTTP Database query error:",o),Response.json({success:!1,error:o.message},{status:500})}}let I=new d.AppRouteRouteModule({definition:{kind:h.x.APP_ROUTE,page:"/api/test-http-db/route",pathname:"/api/test-http-db",filename:"route",bundlePath:"app/api/test-http-db/route"},resolvedPagePath:"/Users/sean/git/alert24-app/app/api/test-http-db/route.js",nextConfigOutput:"",userland:t}),{requestAsyncStorage:H,staticGenerationAsyncStorage:L,serverHooks:D}=I,q="/api/test-http-db/route";function O(){return(0,u.XH)({serverHooks:D,staticGenerationAsyncStorage:L})}let F=_,E=r.a.wrap(I)}},f=>{var m=t=>f(f.s=t);f.O(0,[2720,7883],()=>m(3241));var i=f.O();(p._ENTRIES=typeof p._ENTRIES>"u"?{}:p._ENTRIES)["middleware_app/api/test-http-db/route"]=i}]),function(){let f={exports:{},loaded:!1};return function(i,t){var _=Object.create,r=Object.defineProperty,d=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyNames,u=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,y=e=>r(e,"__esModule",{value:!0}),P=(e,o)=>{y(e);for(var a in o)r(e,a,{get:o[a],enumerable:!0})},w=(e,o,a)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of h(o))!g.call(e,n)&&n!=="default"&&r(e,n,{get:()=>o[n],enumerable:!(a=d(o,n))||a.enumerable});return e},T=e=>w(y(r(e!=null?_(u(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);P(t,{default:()=>q});var j=T((X(),ee(M))),C="@next/request-context",K=Symbol.for(C),S=Symbol.for("internal.storage");function U(){let e=p;if(!e[K]){let o=new j.AsyncLocalStorage,a={get:()=>o.getStore(),[S]:o};e[K]=a}return e[K]}var I=U();function H(e,o){return I[S].run(e,o)}function L(e){let o={};return e&&e.forEach((a,n)=>{o[n]=a,n.toLowerCase()==="set-cookie"&&(o[n]=D(a))}),o}function D(e){let o=[],a=0,n,k,x,R,b;function $(){for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length}function A(){return k=e.charAt(a),k!=="="&&k!==";"&&k!==","}for(;a<e.length;){for(n=a,b=!1;$();)if(k=e.charAt(a),k===","){for(x=a,a+=1,$(),R=a;a<e.length&&A();)a+=1;a<e.length&&e.charAt(a)==="="?(b=!0,a=R,o.push(e.substring(n,x)),n=a):a=x+1}else a+=1;(!b||a>=e.length)&&o.push(e.substring(n,e.length))}return o}function q(e){let o=e.staticRoutes.map(n=>({regexp:new RegExp(n.namedRegex),page:n.page})),a=e.dynamicRoutes?.map(n=>({regexp:new RegExp(n.namedRegex),page:n.page}))||[];return async function(n,k){let x=new URL(n.url).pathname,R={};if(e.nextConfig?.basePath&&x.startsWith(e.nextConfig.basePath)&&(x=x.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let $ of e.nextConfig.i18n.locales){let A=new RegExp(`^/${$}($|/)`,"i");if(x.match(A)){x=x.replace(A,"/")||"/";break}}for(let $ of o)if($.regexp.exec(x)){R.name=$.page;break}if(!R.name){let $=F(x);for(let A of a||[]){if($&&!F(A.page))continue;let z=A.regexp.exec(x);if(z){R={name:A.page,params:z.groups};break}}}let b=await H({waitUntil:k.waitUntil},()=>p._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:n.url,method:n.method,headers:L(n.headers),ip:O(n.headers,E.Ip),geo:{city:O(n.headers,E.City,!0),country:O(n.headers,E.Country,!0),latitude:O(n.headers,E.Latitude),longitude:O(n.headers,E.Longitude),region:O(n.headers,E.Region,!0)},nextConfig:e.nextConfig,page:R,body:n.body}}));return b.waitUntil&&k.waitUntil(b.waitUntil),b.response}}function O(e,o,a=!1){let n=e.get(o)||void 0;return a&&n?decodeURIComponent(n):n}function F(e){return e==="/api"||e.startsWith("/api/")}var E;(function(e){e.City="x-vercel-ip-city",e.Country="x-vercel-ip-country",e.Ip="x-real-ip",e.Latitude="x-vercel-ip-latitude",e.Longitude="x-vercel-ip-longitude",e.Region="x-vercel-ip-country-region"})(E||(E={}))}(f,f.exports),f.exports}.call({}).default({name:"app/api/test-http-db/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/accept-invitation",regex:"^/accept\\-invitation(?:/)?$",routeKeys:{},namedRegex:"^/accept\\-invitation(?:/)?$"},{page:"/debug-email",regex:"^/debug\\-email(?:/)?$",routeKeys:{},namedRegex:"^/debug\\-email(?:/)?$"},{page:"/debug-monitoring",regex:"^/debug\\-monitoring(?:/)?$",routeKeys:{},namedRegex:"^/debug\\-monitoring(?:/)?$"},{page:"/escalation-policies/new",regex:"^/escalation\\-policies/new(?:/)?$",routeKeys:{},namedRegex:"^/escalation\\-policies/new(?:/)?$"},{page:"/favicon.ico",regex:"^/favicon\\.ico(?:/)?$",routeKeys:{},namedRegex:"^/favicon\\.ico(?:/)?$"},{page:"/help",regex:"^/help(?:/)?$",routeKeys:{},namedRegex:"^/help(?:/)?$"},{page:"/incidents",regex:"^/incidents(?:/)?$",routeKeys:{},namedRegex:"^/incidents(?:/)?$"},{page:"/incidents/new",regex:"^/incidents/new(?:/)?$",routeKeys:{},namedRegex:"^/incidents/new(?:/)?$"},{page:"/monitoring",regex:"^/monitoring(?:/)?$",routeKeys:{},namedRegex:"^/monitoring(?:/)?$"},{page:"/monitoring/new",regex:"^/monitoring/new(?:/)?$",routeKeys:{},namedRegex:"^/monitoring/new(?:/)?$"},{page:"/on-call",regex:"^/on\\-call(?:/)?$",routeKeys:{},namedRegex:"^/on\\-call(?:/)?$"},{page:"/on-call/new",regex:"^/on\\-call/new(?:/)?$",routeKeys:{},namedRegex:"^/on\\-call/new(?:/)?$"},{page:"/organizations",regex:"^/organizations(?:/)?$",routeKeys:{},namedRegex:"^/organizations(?:/)?$"},{page:"/profile",regex:"^/profile(?:/)?$",routeKeys:{},namedRegex:"^/profile(?:/)?$"},{page:"/settings",regex:"^/settings(?:/)?$",routeKeys:{},namedRegex:"^/settings(?:/)?$"},{page:"/status-pages",regex:"^/status\\-pages(?:/)?$",routeKeys:{},namedRegex:"^/status\\-pages(?:/)?$"}],dynamicRoutes:[{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"},{page:"/api/incidents/[id]",regex:"^/api/incidents/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/incidents/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/incidents/[id]/updates",regex:"^/api/incidents/([^/]+?)/updates(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/incidents/(?<nxtPid>[^/]+?)/updates(?:/)?$"},{page:"/api/monitoring/[id]",regex:"^/api/monitoring/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/monitoring/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/on-call-schedules/[id]",regex:"^/api/on\\-call\\-schedules/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/on\\-call\\-schedules/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/organizations/[id]",regex:"^/api/organizations/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/organizations/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/organizations/[id]/invitations",regex:"^/api/organizations/([^/]+?)/invitations(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/organizations/(?<nxtPid>[^/]+?)/invitations(?:/)?$"},{page:"/api/services/[id]",regex:"^/api/services/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/services/[id]/monitoring",regex:"^/api/services/([^/]+?)/monitoring(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)/monitoring(?:/)?$"},{page:"/api/services/[id]/sla",regex:"^/api/services/([^/]+?)/sla(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)/sla(?:/)?$"},{page:"/api/status-pages/public/[slug]",regex:"^/api/status\\-pages/public/([^/]+?)(?:/)?$",routeKeys:{nxtPslug:"nxtPslug"},namedRegex:"^/api/status\\-pages/public/(?<nxtPslug>[^/]+?)(?:/)?$"},{page:"/api/status-pages/[id]",regex:"^/api/status\\-pages/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/status\\-pages/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/incidents/[id]",regex:"^/incidents/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/incidents/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/incidents/[id]/edit",regex:"^/incidents/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/incidents/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/monitoring/edit/[id]",regex:"^/monitoring/edit/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/monitoring/edit/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/on-call/[id]/edit",regex:"^/on\\-call/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/on\\-call/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/status/[slug]",regex:"^/status/([^/]+?)(?:/)?$",routeKeys:{nxtPslug:"nxtPslug"},namedRegex:"^/status/(?<nxtPslug>[^/]+?)(?:/)?$"}],nextConfig:{basePath:""}})))(v,v,v);export{kt as default};
