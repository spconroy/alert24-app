var W=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.prototype.hasOwnProperty;var se=(x,v)=>()=>(x&&(v=x(x=0)),v);var J=(x,v,B,E)=>{if(v&&typeof v=="object"||typeof v=="function")for(let p of ee(v))!te.call(x,p)&&p!==B&&W(x,p,{get:()=>v[p],enumerable:!(E=Z(v,p))||E.enumerable});return x},X=(x,v,B)=>(J(x,v,"default"),B&&J(B,v,"default"));var re=x=>J(W({},"__esModule",{value:!0}),x);var q={};import*as vt from"async_hooks";var Q=se(()=>{X(q,vt)});import{__getNamedExports as ne}from"../../../../__next-on-pages-dist__/webpack/ac7e0cd817c0f96ac6506045b651299a.js";import{__getNamedExports as ae}from"../../../../__next-on-pages-dist__/webpack/5c7c089f9b18fab21905bdbf6a451f6c.js";import{__getNamedExports as ie}from"../../../../__next-on-pages-dist__/webpack/fc1dd92f63cefab5577162dd844679df.js";import{__getNamedExports as oe}from"../../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var R=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/monitoring/cron"),m=ne(R,R,R),ce=m.__chunk_6195,ue=m.__chunk_2067,le=m.__chunk_9182,he=m.__chunk_8983,_e=m.__chunk_5228,de=m.__chunk_2296,pe=m.__chunk_2594,ge=m.__chunk_6735,me=m.__chunk_8219,fe=m.__chunk_5577,ke=m.__chunk_9254,xe=m.__chunk_9206,ye=m.__chunk_989,$e=m.__chunk_1863,Pe=m.__chunk_3039,we=m.__chunk_335,be=m.__chunk_8042,ve=m.__chunk_7765,Ee=m.__chunk_6991,Oe=m.__chunk_8816,je=m.__chunk_6631,Te=m.__chunk_4828,Ae=m.__chunk_4834,Se=m.__chunk_828,Re=m.__chunk_5927,Ne=m.__chunk_8439,De=m.__chunk_4363,Ce=m.__chunk_2039,Me=m.__chunk_8264,Ie=m.__chunk_1583,Ke=m.__chunk_7908,Fe=m.__chunk_8949,Le=m.__chunk_796,Ue=m.__chunk_1651,Be=m.__chunk_5105,qe=m.__chunk_9642,He=m.__chunk_5028,Ge=m.__chunk_9548,ze=m.__chunk_6914,Je=m.__chunk_7960,Xe=m.__chunk_4337,We=m.__chunk_8819,U=ae(R,R,R),Qe=U.__chunk_6006,Ve=U.__chunk_9985,Ye=U.__chunk_4155,Ze=U.__chunk_9037,et=U.__chunk_5737,tt=U.__chunk_4919,st=U.__chunk_6855,rt=U.__chunk_3607,T=ie(R,R,R),nt=T.__chunk_1730,at=T.__chunk_3818,it=T.__chunk_7037,ot=T.__chunk_9573,ct=T.__chunk_7701,ut=T.__chunk_662,lt=T.__chunk_4101,ht=T.__chunk_6776,_t=T.__chunk_3665,dt=T.__chunk_7444,pt=T.__chunk_4591,gt=T.__chunk_7983,mt=T.__chunk_581,ft=T.__chunk_2561,kt=T.__chunk_2988,xt=T.__chunk_6947,yt=T.__chunk_5996,$t=T.__chunk_676,V=oe(R,R,R),Pt=V.__NEXT_FONT_MANIFEST,wt=V.__REACT_LOADABLE_MANIFEST,At=((x,v,B)=>(v._ENTRIES={},x.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/fd9d1056-30de07f4a3c346ee.js","static/chunks/7466-8fdf295a7c02cf2e.js","static/chunks/main-app-8eaf6dc4ad0df15d.js"],pages:{"/_app":["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/framework-8e0e0f4a6b83a956.js","static/chunks/main-17007a384daea84e.js","static/chunks/pages/_app-3c9ca398d360b709.js"],"/_error":["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/framework-8e0e0f4a6b83a956.js","static/chunks/main-17007a384daea84e.js","static/chunks/pages/_error-cf5ca766ac8f493f.js"]},ampFirstPages:[]},x.__BUILD_MANIFEST.lowPriorityFiles=["/static/5vAXtrh2qjJDoCjPjRb93/_buildManifest.js",,"/static/5vAXtrh2qjJDoCjPjRb93/_ssgManifest.js"],x.__REACT_LOADABLE_MANIFEST=wt,x.__NEXT_FONT_MANIFEST=Pt,x.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var E={},p={};function u(c){var _=p[c];if(_!==void 0)return _.exports;var l=p[c]={exports:{}},d=!0;try{E[c].call(l.exports,l,l.exports,u),d=!1}finally{d&&delete p[c]}return l.exports}u.m=E,u.amdO={},(()=>{var c=[];u.O=(_,l,d,t)=>{if(l){t=t||0;for(var e=c.length;e>0&&c[e-1][2]>t;e--)c[e]=c[e-1];c[e]=[l,d,t];return}for(var n=1/0,e=0;e<c.length;e++){for(var[l,d,t]=c[e],i=!0,h=0;h<l.length;h++)n>=t&&Object.keys(u.O).every(D=>u.O[D](l[h]))?l.splice(h--,1):(i=!1,t<n&&(n=t));if(i){c.splice(e--,1);var g=d();g!==void 0&&(_=g)}}return _}})(),u.n=c=>{var _=c&&c.__esModule?()=>c.default:()=>c;return u.d(_,{a:_}),_},(()=>{var c,_=Object.getPrototypeOf?l=>Object.getPrototypeOf(l):l=>l.__proto__;u.t=function(l,d){if(1&d&&(l=this(l)),8&d||typeof l=="object"&&l&&(4&d&&l.__esModule||16&d&&typeof l.then=="function"))return l;var t=Object.create(null);u.r(t);var e={};c=c||[null,_({}),_([]),_(_)];for(var n=2&d&&l;typeof n=="object"&&!~c.indexOf(n);n=_(n))Object.getOwnPropertyNames(n).forEach(i=>e[i]=()=>l[i]);return e.default=()=>l,u.d(t,e),t}})(),u.d=(c,_)=>{for(var l in _)u.o(_,l)&&!u.o(c,l)&&Object.defineProperty(c,l,{enumerable:!0,get:_[l]})},u.e=()=>Promise.resolve(),u.g=function(){if(typeof v=="object")return v;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),u.o=(c,_)=>Object.prototype.hasOwnProperty.call(c,_),u.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},(()=>{var c={5993:0};u.O.j=d=>c[d]===0;var _=(d,t)=>{var e,n,[i,h,g]=t,k=0;if(i.some(y=>c[y]!==0)){for(e in h)u.o(h,e)&&(u.m[e]=h[e]);if(g)var b=g(u)}for(d&&d(t);k<i.length;k++)n=i[k],u.o(c,n)&&c[n]&&c[n][0](),c[n]=0;return u.O(b)},l=x.webpackChunk_N_E=x.webpackChunk_N_E||[];l.forEach(_.bind(null,0)),l.push=_.bind(null,l.push.bind(l))})()})(),(x.webpackChunk_N_E=x.webpackChunk_N_E||[]).push([[2720],{8819:We,4337:Xe,7960:Je,6914:ze,9548:Ge,5028:He,9642:qe,5105:Be,1651:Ue,796:Le,8949:Fe,7908:Ke,1583:Ie,8264:Me,2039:Ce,4363:De,8439:Ne,5927:Re,828:Se,4834:Ae,4828:Te,6631:je,8816:Oe,6991:Ee,7765:ve,8042:be,335:we,3039:Pe,1863:$e,989:ye,9206:xe,9254:ke,5577:fe,8219:me,6735:ge,2594:pe,2296:de,5228:_e,8983:he,9182:le}]),(x.webpackChunk_N_E=x.webpackChunk_N_E||[]).push([[7883],{676:$t,5996:yt,6947:xt,2988:kt,2561:ft,581:mt,7983:gt,4591:pt,7444:dt,3665:_t,6776:ht,4101:lt,662:ut,7701:ct,9573:ot,7037:it,3818:at,1730:nt}]),(x.webpackChunk_N_E=x.webpackChunk_N_E||[]).push([[1377],{3607:rt,4953:function(E,p,u){"use strict";var c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(p,"__esModule",{value:!0});let _=c(u(3607)),l=c(u(6855));class d{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=_.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let i=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var g,k,b;let y=null,O=null,D=null,N=h.status,j=h.statusText;if(h.ok){if(this.method!=="HEAD"){let F=await h.text();F===""||(O=this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?F:JSON.parse(F))}let I=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),K=(k=h.headers.get("content-range"))===null||k===void 0?void 0:k.split("/");I&&K&&K.length>1&&(D=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(O)&&(O.length>1?(y={code:"PGRST116",details:`Results contain ${O.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},O=null,D=null,N=406,j="Not Acceptable"):O=O.length===1?O[0]:null)}else{let I=await h.text();try{y=JSON.parse(I),Array.isArray(y)&&h.status===404&&(O=[],y=null,N=200,j="OK")}catch{h.status===404&&I===""?(N=204,j="No Content"):y={message:I}}if(y&&this.isMaybeSingle&&((b=y?.details)===null||b===void 0?void 0:b.includes("0 rows"))&&(y=null,N=200,j="OK"),y&&this.shouldThrowOnError)throw new l.default(y)}return{error:y,data:O,count:D,status:N,statusText:j}});return this.shouldThrowOnError||(i=i.catch(h=>{var g,k,b;return{error:{message:`${(g=h?.name)!==null&&g!==void 0?g:"FetchError"}: ${h?.message}`,details:`${(k=h?.stack)!==null&&k!==void 0?k:""}`,hint:"",code:`${(b=h?.code)!==null&&b!==void 0?b:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}}p.default=d},4708:function(E,p,u){"use strict";var c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(p,"__esModule",{value:!0});let _=c(u(3449)),l=c(u(5245)),d=u(4919);class t{constructor(n,{headers:i={},schema:h,fetch:g}={}){this.url=n,this.headers=Object.assign(Object.assign({},d.DEFAULT_HEADERS),i),this.schemaName=h,this.fetch=g}from(n){let i=new URL(`${this.url}/${n}`);return new _.default(i,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(n){return new t(this.url,{headers:this.headers,schema:n,fetch:this.fetch})}rpc(n,i={},{head:h=!1,get:g=!1,count:k}={}){let b,y,O=new URL(`${this.url}/rpc/${n}`);h||g?(b=h?"HEAD":"GET",Object.entries(i).filter(([N,j])=>j!==void 0).map(([N,j])=>[N,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([N,j])=>{O.searchParams.append(N,j)})):(b="POST",y=i);let D=Object.assign({},this.headers);return k&&(D.Prefer=`count=${k}`),new l.default({method:b,url:O,headers:D,schema:this.schemaName,body:y,fetch:this.fetch,allowEmpty:!1})}}p.default=t},6855:st,5245:function(E,p,u){"use strict";var c=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(p,"__esModule",{value:!0});let _=c(u(1560));class l extends _.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){let n=Array.from(new Set(e)).map(i=>typeof i=="string"&&RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:i}={}){let h="";i==="plain"?h="pl":i==="phrase"?h="ph":i==="websearch"&&(h="w");let g=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${h}fts${g}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){let i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}}p.default=l},3449:function(E,p,u){"use strict";var c=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(p,"__esModule",{value:!0});let _=c(u(5245));class l{constructor(t,{headers:e={},schema:n,fetch:i}){this.url=t,this.headers=e,this.schema=n,this.fetch=i}select(t,{head:e=!1,count:n}={}){let i=!1,h=(t??"*").split("").map(g=>/\s/.test(g)&&!i?"":(g==='"'&&(i=!i),g)).join("");return this.url.searchParams.set("select",h),n&&(this.headers.Prefer=`count=${n}`),new _.default({method:e?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:n=!0}={}){let i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),e&&i.push(`count=${e}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){let h=t.reduce((g,k)=>g.concat(Object.keys(k)),[]);if(h.length>0){let g=[...new Set(h)].map(k=>`"${k}"`);this.url.searchParams.set("columns",g.join(","))}}return new _.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:i,defaultToNull:h=!0}={}){let g=[`resolution=${n?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&g.push(this.headers.Prefer),i&&g.push(`count=${i}`),h||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(t)){let k=t.reduce((b,y)=>b.concat(Object.keys(y)),[]);if(k.length>0){let b=[...new Set(k)].map(y=>`"${y}"`);this.url.searchParams.set("columns",b.join(","))}}return new _.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){let n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),e&&n.push(`count=${e}`),this.headers.Prefer=n.join(","),new _.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){let e=[];return t&&e.push(`count=${t}`),this.headers.Prefer&&e.unshift(this.headers.Prefer),this.headers.Prefer=e.join(","),new _.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}p.default=l},1560:function(E,p,u){"use strict";var c=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(p,"__esModule",{value:!0});let _=c(u(4953));class l extends _.default{select(t){let e=!1,n=(t??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:i,referencedTable:h=i}={}){let g=h?`${h}.order`:"order",k=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${k?`${k},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){let i=n===void 0?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:i=n}={}){let h=i===void 0?"offset":`${i}.offset`,g=i===void 0?"limit":`${i}.limit`;return this.url.searchParams.set(h,`${t}`),this.url.searchParams.set(g,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:i=!1,wal:h=!1,format:g="text"}={}){var k;let b=[t?"analyze":null,e?"verbose":null,n?"settings":null,i?"buffers":null,h?"wal":null].filter(Boolean).join("|"),y=(k=this.headers.Accept)!==null&&k!==void 0?k:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${g}; for="${y}"; options=${b};`,this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}p.default=l},4919:tt,7483:function(E,p,u){"use strict";var c=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(p,"__esModule",{value:!0}),p.PostgrestError=p.PostgrestBuilder=p.PostgrestTransformBuilder=p.PostgrestFilterBuilder=p.PostgrestQueryBuilder=p.PostgrestClient=void 0;let _=c(u(4708));p.PostgrestClient=_.default;let l=c(u(3449));p.PostgrestQueryBuilder=l.default;let d=c(u(5245));p.PostgrestFilterBuilder=d.default;let t=c(u(1560));p.PostgrestTransformBuilder=t.default;let e=c(u(4953));p.PostgrestBuilder=e.default;let n=c(u(6855));p.PostgrestError=n.default,p.default={PostgrestClient:_.default,PostgrestQueryBuilder:l.default,PostgrestFilterBuilder:d.default,PostgrestTransformBuilder:t.default,PostgrestBuilder:e.default,PostgrestError:n.default}},5737:et,9037:Ze,4155:Ye,9985:Ve}]),(x.webpackChunk_N_E=x.webpackChunk_N_E||[]).push([[6006],{6006:Qe}]),(x.webpackChunk_N_E=x.webpackChunk_N_E||[]).push([[3249],{2067:ue,6195:ce,7490:(E,p,u)=>{"use strict";u.r(p),u.d(p,{ComponentMod:()=>H,default:()=>M});var c={};u.r(c),u.d(c,{GET:()=>g,runtime:()=>h});var _={};u.r(_),u.d(_,{originalPathname:()=>z,patchFetch:()=>L,requestAsyncStorage:()=>I,routeModule:()=>j,serverHooks:()=>F,staticGenerationAsyncStorage:()=>K});var l=u(7983),d=u(2561),t=u(4828),e=u(6631),n=u(9985);let i=new(u(6006))._,h="edge";async function g(s){try{console.log("\u{1F550} Starting monitoring cron job...");let{data:r,error:a}=await i.client.from("monitoring_checks").select("*").eq("status","active").order("last_check_at",{ascending:!0});if(a)return console.error("Error fetching monitoring checks:",a),n.xk.json({error:a.message},{status:500});console.log(`Found ${r.length} active monitoring checks`);let o=[],w=new Date;for(let f of r)try{let A=!1;if(f.last_check_at){let C=new Date(f.last_check_at),G=1e3*(f.check_interval_seconds||300),Y=new Date(C.getTime()+G);A=w>=Y}else A=!0;if(A){console.log(`\u26A1 Executing check: ${f.name}`);let C=await k(f);await N(f.id,C),o.push({checkId:f.id,checkName:f.name,status:"executed",result:{success:C.is_successful,responseTime:C.response_time_ms,statusCode:C.status_code,error:C.error_message}})}else{let C=f.last_check_at?new Date(f.last_check_at):null,G=C?new Date(C.getTime()+1e3*(f.check_interval_seconds||300)):"Never checked";console.log(`\u23F3 Skipping check: ${f.name} (next due: ${G})`),o.push({checkId:f.id,checkName:f.name,status:"skipped",nextDue:G})}}catch(A){console.error(`Error processing check ${f.id}:`,A),o.push({checkId:f.id,checkName:f.name,status:"error",error:A.message})}let $=o.filter(f=>f.status==="executed").length,P=o.filter(f=>f.status==="skipped").length,S=o.filter(f=>f.status==="error").length;return console.log(`\u2705 Cron completed: ${$} executed, ${P} skipped, ${S} errors`),n.xk.json({success:!0,summary:{totalChecks:r.length,executed:$,skipped:P,errors:S},results:o,executedAt:w.toISOString()})}catch(r){return console.error("Monitoring cron error:",r),n.xk.json({success:!1,error:"Cron execution failed",details:r.message},{status:500})}}async function k(s){let r=Date.now(),a={check_id:s.id,timestamp:new Date().toISOString(),is_successful:!1,response_time_ms:null,status_code:null,error_message:null,ssl_info:null};try{if(console.log(`Executing ${s.check_type} check: ${s.name} -> ${s.target_url}`),s.check_type==="http")return await b(s,a,r);if(s.check_type==="ping")return await y(s,a,r);if(s.check_type==="tcp")return await O(s,a,r);if(s.check_type==="ssl")return await D(s,a,r);a.error_message=`Unsupported check type: ${s.check_type}`,a.response_time_ms=Date.now()-r}catch(o){a.response_time_ms=Date.now()-r,a.is_successful=!1,o.name==="AbortError"?a.error_message=`Timeout after ${s.timeout_seconds||30} seconds`:o.code==="ENOTFOUND"||o.code==="ECONNREFUSED"?a.error_message=`DNS resolution failed or connection refused: ${o.message}`:a.error_message=o.message||"Unknown error",console.log(`Check failed: ${s.name} - ${a.error_message}`)}return a}async function b(s,r,a){let o=new AbortController,w=setTimeout(()=>o.abort(),1e3*(s.timeout_seconds||30)),$={method:s.method||"GET",signal:o.signal,redirect:"follow",headers:{"User-Agent":"Alert24-Monitor/1.0",...s.headers}},P=await fetch(s.target_url,$);clearTimeout(w);let S=Date.now()-a;r.response_time_ms=S,r.status_code=P.status;let f=[s.expected_status_code],A=f.includes(P.status);return r.is_successful=A,r.is_successful||r.error_message||(r.error_message=`Status ${P.status} not in expected codes ${f.join(",")}`),r}async function y(s,r,a){let o=s.target_url;s.target_url.includes("://")&&(o=new URL(s.target_url).hostname);let w=new AbortController,$=setTimeout(()=>w.abort(),1e3*(s.timeout_seconds||30));try{let P=await fetch(`http://${o}`,{method:"HEAD",signal:w.signal});clearTimeout($),r.response_time_ms=Date.now()-a,r.status_code=P.status,r.is_successful=!0,r.error_message=null}catch(P){clearTimeout($),r.response_time_ms=Date.now()-a,r.is_successful=!1,r.error_message=P.message}return r}async function O(s,r,a){let o=s.target_url.split(":");if(o.length!==2)return r.response_time_ms=Date.now()-a,r.is_successful=!1,r.error_message="TCP check requires hostname:port format",r;let w=o[0],$=parseInt(o[1]),P=new AbortController,S=setTimeout(()=>P.abort(),1e3*(s.timeout_seconds||30));try{let f=await fetch(`http://${w}:${$}`,{method:"HEAD",signal:P.signal});clearTimeout(S),r.response_time_ms=Date.now()-a,r.status_code=f.status,r.is_successful=!0,r.error_message=null}catch(f){clearTimeout(S),r.response_time_ms=Date.now()-a,r.is_successful=!1,r.error_message=`TCP connection to ${w}:${$} failed - ${f.message}`}return r}async function D(s,r,a){let o=s.target_url;o.startsWith("https://")||(o=`https://${s.target_url}`);let w=new AbortController,$=setTimeout(()=>w.abort(),1e3*(s.timeout_seconds||30));try{let P=await fetch(o,{method:"HEAD",signal:w.signal});clearTimeout($),r.response_time_ms=Date.now()-a,r.status_code=P.status,r.is_successful=P.status<500,r.ssl_info={valid:!0,expires_at:null,days_until_expiry:null},r.error_message=r.is_successful?null:`SSL check failed with status ${P.status}`}catch(P){clearTimeout($),r.response_time_ms=Date.now()-a,r.is_successful=!1,r.error_message=`SSL check failed - ${P.message}`}return r}async function N(s,r){try{try{await i.createCheckResult({monitoring_check_id:s,is_successful:r.is_successful,response_time_ms:r.response_time_ms,status_code:r.status_code,error_message:r.error_message,ssl_info:r.ssl_info})}catch(w){console.warn("Could not store check result:",w.message)}let a={current_status:r.is_successful?"up":"down",last_check_at:new Date().toISOString(),updated_at:new Date().toISOString()};r.is_successful?(a.last_success_at=new Date().toISOString(),a.failure_message=null):(a.last_failure_at=new Date().toISOString(),a.failure_message=r.error_message);let{error:o}=await i.client.from("monitoring_checks").update(a).eq("id",s);o?console.error("Error updating monitoring check:",o):console.log(`Updated check ${s}: ${r.is_successful?"SUCCESS":"FAILED"} (${r.response_time_ms}ms)`)}catch(a){console.error("Error updating monitoring check status:",a)}}let j=new d.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/monitoring/cron/route",pathname:"/api/monitoring/cron",filename:"route",bundlePath:"app/api/monitoring/cron/route"},resolvedPagePath:"/Users/sean/git/alert24-app/app/api/monitoring/cron/route.js",nextConfigOutput:"",userland:c}),{requestAsyncStorage:I,staticGenerationAsyncStorage:K,serverHooks:F}=j,z="/api/monitoring/cron/route";function L(){return(0,e.XH)({serverHooks:F,staticGenerationAsyncStorage:K})}let H=_,M=l.a.wrap(j)}},E=>{var p=c=>E(E.s=c);E.O(0,[2720,7883,1377,6006],()=>p(7490));var u=E.O();(v._ENTRIES=typeof v._ENTRIES>"u"?{}:v._ENTRIES)["middleware_app/api/monitoring/cron/route"]=u}]),function(){let E={exports:{},loaded:!1};return function(u,c){var _=Object.create,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,e=Object.getPrototypeOf,n=Object.prototype.hasOwnProperty,i=s=>l(s,"__esModule",{value:!0}),h=(s,r)=>{i(s);for(var a in r)l(s,a,{get:r[a],enumerable:!0})},g=(s,r,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of t(r))!n.call(s,o)&&o!=="default"&&l(s,o,{get:()=>r[o],enumerable:!(a=d(r,o))||a.enumerable});return s},k=s=>g(i(l(s!=null?_(e(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);h(c,{default:()=>z});var b=k((Q(),re(q))),y="@next/request-context",O=Symbol.for(y),D=Symbol.for("internal.storage");function N(){let s=v;if(!s[O]){let r=new b.AsyncLocalStorage,a={get:()=>r.getStore(),[D]:r};s[O]=a}return s[O]}var j=N();function I(s,r){return j[D].run(s,r)}function K(s){let r={};return s&&s.forEach((a,o)=>{r[o]=a,o.toLowerCase()==="set-cookie"&&(r[o]=F(a))}),r}function F(s){let r=[],a=0,o,w,$,P,S;function f(){for(;a<s.length&&/\s/.test(s.charAt(a));)a+=1;return a<s.length}function A(){return w=s.charAt(a),w!=="="&&w!==";"&&w!==","}for(;a<s.length;){for(o=a,S=!1;f();)if(w=s.charAt(a),w===","){for($=a,a+=1,f(),P=a;a<s.length&&A();)a+=1;a<s.length&&s.charAt(a)==="="?(S=!0,a=P,r.push(s.substring(o,$)),o=a):a=$+1}else a+=1;(!S||a>=s.length)&&r.push(s.substring(o,s.length))}return r}function z(s){let r=s.staticRoutes.map(o=>({regexp:new RegExp(o.namedRegex),page:o.page})),a=s.dynamicRoutes?.map(o=>({regexp:new RegExp(o.namedRegex),page:o.page}))||[];return async function(o,w){let $=new URL(o.url).pathname,P={};if(s.nextConfig?.basePath&&$.startsWith(s.nextConfig.basePath)&&($=$.replace(s.nextConfig.basePath,"")||"/"),s.nextConfig?.i18n)for(let f of s.nextConfig.i18n.locales){let A=new RegExp(`^/${f}($|/)`,"i");if($.match(A)){$=$.replace(A,"/")||"/";break}}for(let f of r)if(f.regexp.exec($)){P.name=f.page;break}if(!P.name){let f=H($);for(let A of a||[]){if(f&&!H(A.page))continue;let C=A.regexp.exec($);if(C){P={name:A.page,params:C.groups};break}}}let S=await I({waitUntil:w.waitUntil},()=>v._ENTRIES[`middleware_${s.name}`].default.call({},{request:{url:o.url,method:o.method,headers:K(o.headers),ip:L(o.headers,M.Ip),geo:{city:L(o.headers,M.City,!0),country:L(o.headers,M.Country,!0),latitude:L(o.headers,M.Latitude),longitude:L(o.headers,M.Longitude),region:L(o.headers,M.Region,!0)},nextConfig:s.nextConfig,page:P,body:o.body}}));return S.waitUntil&&w.waitUntil(S.waitUntil),S.response}}function L(s,r,a=!1){let o=s.get(r)||void 0;return a&&o?decodeURIComponent(o):o}function H(s){return s==="/api"||s.startsWith("/api/")}var M;(function(s){s.City="x-vercel-ip-city",s.Country="x-vercel-ip-country",s.Ip="x-real-ip",s.Latitude="x-vercel-ip-latitude",s.Longitude="x-vercel-ip-longitude",s.Region="x-vercel-ip-country-region"})(M||(M={}))}(E,E.exports),E.exports}.call({}).default({name:"app/api/monitoring/cron/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/accept-invitation",regex:"^/accept\\-invitation(?:/)?$",routeKeys:{},namedRegex:"^/accept\\-invitation(?:/)?$"},{page:"/debug-email",regex:"^/debug\\-email(?:/)?$",routeKeys:{},namedRegex:"^/debug\\-email(?:/)?$"},{page:"/debug-monitoring",regex:"^/debug\\-monitoring(?:/)?$",routeKeys:{},namedRegex:"^/debug\\-monitoring(?:/)?$"},{page:"/escalation-policies/new",regex:"^/escalation\\-policies/new(?:/)?$",routeKeys:{},namedRegex:"^/escalation\\-policies/new(?:/)?$"},{page:"/favicon.ico",regex:"^/favicon\\.ico(?:/)?$",routeKeys:{},namedRegex:"^/favicon\\.ico(?:/)?$"},{page:"/help",regex:"^/help(?:/)?$",routeKeys:{},namedRegex:"^/help(?:/)?$"},{page:"/incidents",regex:"^/incidents(?:/)?$",routeKeys:{},namedRegex:"^/incidents(?:/)?$"},{page:"/incidents/new",regex:"^/incidents/new(?:/)?$",routeKeys:{},namedRegex:"^/incidents/new(?:/)?$"},{page:"/monitoring",regex:"^/monitoring(?:/)?$",routeKeys:{},namedRegex:"^/monitoring(?:/)?$"},{page:"/monitoring/new",regex:"^/monitoring/new(?:/)?$",routeKeys:{},namedRegex:"^/monitoring/new(?:/)?$"},{page:"/on-call",regex:"^/on\\-call(?:/)?$",routeKeys:{},namedRegex:"^/on\\-call(?:/)?$"},{page:"/on-call/new",regex:"^/on\\-call/new(?:/)?$",routeKeys:{},namedRegex:"^/on\\-call/new(?:/)?$"},{page:"/organizations",regex:"^/organizations(?:/)?$",routeKeys:{},namedRegex:"^/organizations(?:/)?$"},{page:"/profile",regex:"^/profile(?:/)?$",routeKeys:{},namedRegex:"^/profile(?:/)?$"},{page:"/settings",regex:"^/settings(?:/)?$",routeKeys:{},namedRegex:"^/settings(?:/)?$"},{page:"/status-pages",regex:"^/status\\-pages(?:/)?$",routeKeys:{},namedRegex:"^/status\\-pages(?:/)?$"}],dynamicRoutes:[{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"},{page:"/api/incidents/[id]",regex:"^/api/incidents/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/incidents/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/incidents/[id]/updates",regex:"^/api/incidents/([^/]+?)/updates(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/incidents/(?<nxtPid>[^/]+?)/updates(?:/)?$"},{page:"/api/monitoring/[id]",regex:"^/api/monitoring/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/monitoring/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/on-call-schedules/[id]",regex:"^/api/on\\-call\\-schedules/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/on\\-call\\-schedules/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/organizations/[id]",regex:"^/api/organizations/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/organizations/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/organizations/[id]/invitations",regex:"^/api/organizations/([^/]+?)/invitations(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/organizations/(?<nxtPid>[^/]+?)/invitations(?:/)?$"},{page:"/api/services/[id]",regex:"^/api/services/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/services/[id]/monitoring",regex:"^/api/services/([^/]+?)/monitoring(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)/monitoring(?:/)?$"},{page:"/api/services/[id]/sla",regex:"^/api/services/([^/]+?)/sla(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)/sla(?:/)?$"},{page:"/api/status-pages/public/[slug]",regex:"^/api/status\\-pages/public/([^/]+?)(?:/)?$",routeKeys:{nxtPslug:"nxtPslug"},namedRegex:"^/api/status\\-pages/public/(?<nxtPslug>[^/]+?)(?:/)?$"},{page:"/api/status-pages/[id]",regex:"^/api/status\\-pages/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/status\\-pages/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/incidents/[id]",regex:"^/incidents/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/incidents/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/incidents/[id]/edit",regex:"^/incidents/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/incidents/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/monitoring/edit/[id]",regex:"^/monitoring/edit/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/monitoring/edit/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/on-call/[id]/edit",regex:"^/on\\-call/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/on\\-call/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/status/[slug]",regex:"^/status/([^/]+?)(?:/)?$",routeKeys:{nxtPslug:"nxtPslug"},namedRegex:"^/status/(?<nxtPslug>[^/]+?)(?:/)?$"}],nextConfig:{basePath:""}})))(R,R,R);export{At as default};
