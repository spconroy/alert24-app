var ee=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var se=Object.getOwnPropertyNames;var ie=Object.prototype.hasOwnProperty;var ae=(k,b)=>()=>(k&&(b=k(k=0)),b);var V=(k,b,L,w)=>{if(b&&typeof b=="object"||typeof b=="function")for(let p of se(b))!ie.call(k,p)&&p!==L&&ee(k,p,{get:()=>b[p],enumerable:!(w=re(b,p))||w.enumerable});return k},Y=(k,b,L)=>(V(k,b,"default"),L&&V(L,b,"default"));var oe=k=>V(ee({},"__esModule",{value:!0}),k);var H={};import*as Dt from"async_hooks";var te=ae(()=>{Y(H,Dt)});import{__getNamedExports as ce}from"../../../__next-on-pages-dist__/webpack/5856.js";import{__getNamedExports as ue}from"../../../__next-on-pages-dist__/webpack/7138.js";import{__getNamedExports as he}from"../../../__next-on-pages-dist__/webpack/aa5c0a3237ae1fd635b2d0bab25b6e94.js";import{__getNamedExports as _e}from"../../../__next-on-pages-dist__/webpack/ac7e0cd817c0f96ac6506045b651299a.js";import{__getNamedExports as de}from"../../../__next-on-pages-dist__/webpack/5c7c089f9b18fab21905bdbf6a451f6c.js";import{__getNamedExports as le}from"../../../__next-on-pages-dist__/webpack/fc1dd92f63cefab5577162dd844679df.js";import{__getNamedExports as pe}from"../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var v=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/incidents"),ge=ce(v,v,v),fe=ge.__chunk_5856,me=ue(v,v,v),xe=me.__chunk_7138,Z=he(v,v,v),ke=Z.__chunk_6095,ye=Z.__chunk_3543,Pe=Z.__chunk_2641,g=_e(v,v,v),ve=g.__chunk_6195,$e=g.__chunk_2067,be=g.__chunk_9182,we=g.__chunk_8983,Ee=g.__chunk_5228,Oe=g.__chunk_2296,Re=g.__chunk_2594,je=g.__chunk_6735,Ne=g.__chunk_8219,Ae=g.__chunk_5577,Te=g.__chunk_9254,Se=g.__chunk_9206,Ie=g.__chunk_989,Me=g.__chunk_1863,Ce=g.__chunk_3039,ze=g.__chunk_335,Ke=g.__chunk_8042,De=g.__chunk_7765,Fe=g.__chunk_6991,Be=g.__chunk_8816,Ue=g.__chunk_6631,qe=g.__chunk_4828,Le=g.__chunk_4834,Xe=g.__chunk_828,He=g.__chunk_5927,Ge=g.__chunk_8439,Je=g.__chunk_4363,Qe=g.__chunk_2039,We=g.__chunk_8264,Ve=g.__chunk_1583,Ye=g.__chunk_7908,Ze=g.__chunk_8949,et=g.__chunk_796,tt=g.__chunk_1651,nt=g.__chunk_5105,rt=g.__chunk_9642,st=g.__chunk_5028,it=g.__chunk_9548,at=g.__chunk_6914,ot=g.__chunk_7960,ct=g.__chunk_4337,ut=g.__chunk_8819,U=de(v,v,v),ht=U.__chunk_6006,_t=U.__chunk_9985,dt=U.__chunk_4155,lt=U.__chunk_9037,pt=U.__chunk_5737,gt=U.__chunk_4919,ft=U.__chunk_6855,mt=U.__chunk_3607,N=le(v,v,v),xt=N.__chunk_1730,kt=N.__chunk_3818,yt=N.__chunk_7037,Pt=N.__chunk_9573,vt=N.__chunk_7701,$t=N.__chunk_662,bt=N.__chunk_4101,wt=N.__chunk_6776,Et=N.__chunk_3665,Ot=N.__chunk_7444,Rt=N.__chunk_4591,jt=N.__chunk_7983,Nt=N.__chunk_581,At=N.__chunk_2561,Tt=N.__chunk_2988,St=N.__chunk_6947,It=N.__chunk_5996,Mt=N.__chunk_676,ne=pe(v,v,v),Ct=ne.__NEXT_FONT_MANIFEST,zt=ne.__REACT_LOADABLE_MANIFEST,Gt=((k,b,L)=>(b._ENTRIES={},k.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/fd9d1056-30de07f4a3c346ee.js","static/chunks/7466-8fdf295a7c02cf2e.js","static/chunks/main-app-8eaf6dc4ad0df15d.js"],pages:{"/_app":["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/framework-8e0e0f4a6b83a956.js","static/chunks/main-17007a384daea84e.js","static/chunks/pages/_app-3c9ca398d360b709.js"],"/_error":["static/chunks/webpack-ba48b7ef278912ed.js","static/chunks/framework-8e0e0f4a6b83a956.js","static/chunks/main-17007a384daea84e.js","static/chunks/pages/_error-cf5ca766ac8f493f.js"]},ampFirstPages:[]},k.__BUILD_MANIFEST.lowPriorityFiles=["/static/5vAXtrh2qjJDoCjPjRb93/_buildManifest.js",,"/static/5vAXtrh2qjJDoCjPjRb93/_ssgManifest.js"],k.__REACT_LOADABLE_MANIFEST=zt,k.__NEXT_FONT_MANIFEST=Ct,k.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var w={},p={};function a(i){var d=p[i];if(d!==void 0)return d.exports;var c=p[i]={exports:{}},l=!0;try{w[i].call(c.exports,c,c.exports,a),l=!1}finally{l&&delete p[i]}return c.exports}a.m=w,a.amdO={},(()=>{var i=[];a.O=(d,c,l,t)=>{if(c){t=t||0;for(var e=i.length;e>0&&i[e-1][2]>t;e--)i[e]=i[e-1];i[e]=[c,l,t];return}for(var s=1/0,e=0;e<i.length;e++){for(var[c,l,t]=i[e],n=!0,u=0;u<c.length;u++)s>=t&&Object.keys(a.O).every(I=>a.O[I](c[u]))?c.splice(u--,1):(n=!1,t<s&&(s=t));if(n){i.splice(e--,1);var o=l();o!==void 0&&(d=o)}}return d}})(),a.n=i=>{var d=i&&i.__esModule?()=>i.default:()=>i;return a.d(d,{a:d}),d},(()=>{var i,d=Object.getPrototypeOf?c=>Object.getPrototypeOf(c):c=>c.__proto__;a.t=function(c,l){if(1&l&&(c=this(c)),8&l||typeof c=="object"&&c&&(4&l&&c.__esModule||16&l&&typeof c.then=="function"))return c;var t=Object.create(null);a.r(t);var e={};i=i||[null,d({}),d([]),d(d)];for(var s=2&l&&c;typeof s=="object"&&!~i.indexOf(s);s=d(s))Object.getOwnPropertyNames(s).forEach(n=>e[n]=()=>c[n]);return e.default=()=>c,a.d(t,e),t}})(),a.d=(i,d)=>{for(var c in d)a.o(d,c)&&!a.o(i,c)&&Object.defineProperty(i,c,{enumerable:!0,get:d[c]})},a.e=()=>Promise.resolve(),a.g=function(){if(typeof b=="object")return b;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),a.o=(i,d)=>Object.prototype.hasOwnProperty.call(i,d),a.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},(()=>{var i={5993:0};a.O.j=l=>i[l]===0;var d=(l,t)=>{var e,s,[n,u,o]=t,x=0;if(n.some(y=>i[y]!==0)){for(e in u)a.o(u,e)&&(a.m[e]=u[e]);if(o)var $=o(a)}for(l&&l(t);x<n.length;x++)s=n[x],a.o(i,s)&&i[s]&&i[s][0](),i[s]=0;return a.O($)},c=k.webpackChunk_N_E=k.webpackChunk_N_E||[];c.forEach(d.bind(null,0)),c.push=d.bind(null,c.push.bind(c))})()})(),(k.webpackChunk_N_E=k.webpackChunk_N_E||[]).push([[2720],{8819:ut,4337:ct,7960:ot,6914:at,9548:it,5028:st,9642:rt,5105:nt,1651:tt,796:et,8949:Ze,7908:Ye,1583:Ve,8264:We,2039:Qe,4363:Je,8439:Ge,5927:He,828:Xe,4834:Le,4828:qe,6631:Ue,8816:Be,6991:Fe,7765:De,8042:Ke,335:ze,3039:Ce,1863:Me,989:Ie,9206:Se,9254:Te,5577:Ae,8219:Ne,6735:je,2594:Re,2296:Oe,5228:Ee,8983:we,9182:be}]),(k.webpackChunk_N_E=k.webpackChunk_N_E||[]).push([[7883],{676:Mt,5996:It,6947:St,2988:Tt,2561:At,581:Nt,7983:jt,4591:Rt,7444:Ot,3665:Et,6776:wt,4101:bt,662:$t,7701:vt,9573:Pt,7037:yt,3818:kt,1730:xt}]),(k.webpackChunk_N_E=k.webpackChunk_N_E||[]).push([[1377],{3607:mt,4953:function(w,p,a){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(p,"__esModule",{value:!0});let d=i(a(3607)),c=i(a(6855));class l{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=d.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,s){return this.headers=Object.assign({},this.headers),this.headers[e]=s,this}then(e,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var o,x,$;let y=null,R=null,I=null,S=u.status,j=u.statusText;if(u.ok){if(this.method!=="HEAD"){let D=await u.text();D===""||(R=this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?D:JSON.parse(D))}let z=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),K=(x=u.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");z&&K&&K.length>1&&(I=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(R)&&(R.length>1?(y={code:"PGRST116",details:`Results contain ${R.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},R=null,I=null,S=406,j="Not Acceptable"):R=R.length===1?R[0]:null)}else{let z=await u.text();try{y=JSON.parse(z),Array.isArray(y)&&u.status===404&&(R=[],y=null,S=200,j="OK")}catch{u.status===404&&z===""?(S=204,j="No Content"):y={message:z}}if(y&&this.isMaybeSingle&&(($=y?.details)===null||$===void 0?void 0:$.includes("0 rows"))&&(y=null,S=200,j="OK"),y&&this.shouldThrowOnError)throw new c.default(y)}return{error:y,data:R,count:I,status:S,statusText:j}});return this.shouldThrowOnError||(n=n.catch(u=>{var o,x,$;return{error:{message:`${(o=u?.name)!==null&&o!==void 0?o:"FetchError"}: ${u?.message}`,details:`${(x=u?.stack)!==null&&x!==void 0?x:""}`,hint:"",code:`${($=u?.code)!==null&&$!==void 0?$:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,s)}returns(){return this}overrideTypes(){return this}}p.default=l},4708:function(w,p,a){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(p,"__esModule",{value:!0});let d=i(a(3449)),c=i(a(5245)),l=a(4919);class t{constructor(s,{headers:n={},schema:u,fetch:o}={}){this.url=s,this.headers=Object.assign(Object.assign({},l.DEFAULT_HEADERS),n),this.schemaName=u,this.fetch=o}from(s){let n=new URL(`${this.url}/${s}`);return new d.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new t(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,n={},{head:u=!1,get:o=!1,count:x}={}){let $,y,R=new URL(`${this.url}/rpc/${s}`);u||o?($=u?"HEAD":"GET",Object.entries(n).filter(([S,j])=>j!==void 0).map(([S,j])=>[S,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([S,j])=>{R.searchParams.append(S,j)})):($="POST",y=n);let I=Object.assign({},this.headers);return x&&(I.Prefer=`count=${x}`),new c.default({method:$,url:R,headers:I,schema:this.schemaName,body:y,fetch:this.fetch,allowEmpty:!1})}}p.default=t},6855:ft,5245:function(w,p,a){"use strict";var i=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(p,"__esModule",{value:!0});let d=i(a(1560));class c extends d.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){let s=Array.from(new Set(e)).map(n=>typeof n=="string"&&RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${s})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:s,type:n}={}){let u="";n==="plain"?u="pl":n==="phrase"?u="ph":n==="websearch"&&(u="w");let o=s===void 0?"":`(${s})`;return this.url.searchParams.append(t,`${u}fts${o}.${e}`),this}match(t){return Object.entries(t).forEach(([e,s])=>{this.url.searchParams.append(e,`eq.${s}`)}),this}not(t,e,s){return this.url.searchParams.append(t,`not.${e}.${s}`),this}or(t,{foreignTable:e,referencedTable:s=e}={}){let n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,e,s){return this.url.searchParams.append(t,`${e}.${s}`),this}}p.default=c},3449:function(w,p,a){"use strict";var i=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(p,"__esModule",{value:!0});let d=i(a(5245));class c{constructor(t,{headers:e={},schema:s,fetch:n}){this.url=t,this.headers=e,this.schema=s,this.fetch=n}select(t,{head:e=!1,count:s}={}){let n=!1,u=(t??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",u),s&&(this.headers.Prefer=`count=${s}`),new d.default({method:e?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:s=!0}={}){let n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),e&&n.push(`count=${e}`),s||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(t)){let u=t.reduce((o,x)=>o.concat(Object.keys(x)),[]);if(u.length>0){let o=[...new Set(u)].map(x=>`"${x}"`);this.url.searchParams.set("columns",o.join(","))}}return new d.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:s=!1,count:n,defaultToNull:u=!0}={}){let o=[`resolution=${s?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),u||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){let x=t.reduce(($,y)=>$.concat(Object.keys(y)),[]);if(x.length>0){let $=[...new Set(x)].map(y=>`"${y}"`);this.url.searchParams.set("columns",$.join(","))}}return new d.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){let s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),this.headers.Prefer=s.join(","),new d.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){let e=[];return t&&e.push(`count=${t}`),this.headers.Prefer&&e.unshift(this.headers.Prefer),this.headers.Prefer=e.join(","),new d.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}p.default=c},1560:function(w,p,a){"use strict";var i=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(p,"__esModule",{value:!0});let d=i(a(4953));class c extends d.default{select(t){let e=!1,s=(t??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:s,foreignTable:n,referencedTable:u=n}={}){let o=u?`${u}.order`:"order",x=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${x?`${x},`:""}${t}.${e?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:s=e}={}){let n=s===void 0?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,e,{foreignTable:s,referencedTable:n=s}={}){let u=n===void 0?"offset":`${n}.offset`,o=n===void 0?"limit":`${n}.limit`;return this.url.searchParams.set(u,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:s=!1,buffers:n=!1,wal:u=!1,format:o="text"}={}){var x;let $=[t?"analyze":null,e?"verbose":null,s?"settings":null,n?"buffers":null,u?"wal":null].filter(Boolean).join("|"),y=(x=this.headers.Accept)!==null&&x!==void 0?x:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${y}"; options=${$};`,this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}p.default=c},4919:gt,7483:function(w,p,a){"use strict";var i=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(p,"__esModule",{value:!0}),p.PostgrestError=p.PostgrestBuilder=p.PostgrestTransformBuilder=p.PostgrestFilterBuilder=p.PostgrestQueryBuilder=p.PostgrestClient=void 0;let d=i(a(4708));p.PostgrestClient=d.default;let c=i(a(3449));p.PostgrestQueryBuilder=c.default;let l=i(a(5245));p.PostgrestFilterBuilder=l.default;let t=i(a(1560));p.PostgrestTransformBuilder=t.default;let e=i(a(4953));p.PostgrestBuilder=e.default;let s=i(a(6855));p.PostgrestError=s.default,p.default={PostgrestClient:d.default,PostgrestQueryBuilder:c.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:t.default,PostgrestBuilder:e.default,PostgrestError:s.default}},5737:pt,9037:lt,4155:dt,9985:_t}]),(k.webpackChunk_N_E=k.webpackChunk_N_E||[]).push([[3452],{2641:Pe,3543:ye}]),(k.webpackChunk_N_E=k.webpackChunk_N_E||[]).push([[6006],{6006:ht}]),(k.webpackChunk_N_E=k.webpackChunk_N_E||[]).push([[558],{2067:$e,6195:ve,6265:(w,p,a)=>{"use strict";a.r(p),a.d(p,{ComponentMod:()=>G,default:()=>C});var i={};a.r(i),a.d(i,{DELETE:()=>S,GET:()=>y,POST:()=>R,PUT:()=>I,runtime:()=>x});var d={};a.r(d),a.d(d,{originalPathname:()=>Q,patchFetch:()=>B,requestAsyncStorage:()=>z,routeModule:()=>j,serverHooks:()=>D,staticGenerationAsyncStorage:()=>K});var c=a(7983),l=a(2561),t=a(4828),e=a(6631);a(9985);var s=a(6006),n=a(7138),u=a(5856);let o=new s._,x="edge";async function $(r,m){try{let _=await o.getOrganizationById(m);if(!_){console.error("Organization not found for incident:",r.id);return}let h=(await o.getOrganizationMembersByOrganization(m)).filter(f=>["admin","owner","responder"].includes(f.role)&&f.email_notifications_enabled!==!1),P=`${process.env.NEXTAUTH_URL||"http://localhost:3000"}/incidents/${r.id}`;for(let f of h)try{await u.y.sendIncidentNotification({toEmail:f.users?.email||f.email,toName:f.users?.name||f.name,organizationName:_.name,incidentTitle:r.title,incidentDescription:r.description||"No description provided",severity:r.severity,status:r.status,incidentUrl:P,organizationBranding:{name:_.name,logoUrl:_.logo_url}}),console.log(`\u{1F4E7} Incident notification sent to ${f.users?.email||f.email}`)}catch(E){console.error(`Failed to send incident notification to ${f.users?.email||f.email}:`,E)}}catch(_){console.error("Error sending incident notifications:",_)}}let y=(0,n.xX)(async r=>{let m=await n.gx.requireAuth(),_=await n.gx.requireUser(o,m.user.email),{searchParams:h}=new URL(r.url),P=h.get("organization_id"),f=h.get("status"),E=Math.min(parseInt(h.get("limit"))||25,100),O=Math.max(parseInt(h.get("offset"))||0,0);if(!P)return n.Rf.badRequest("Organization ID is required");n.cX.uuid(P,"organization_id"),f&&n.cX.enum(f,["open","investigating","identified","monitoring","resolved"],"status"),await n.gx.requireOrganizationMember(o,P,_.id);let A=await o.getIncidentsByOrganization(P),T=f?A.filter(q=>q.status===f):A,F=T.slice(O,O+E);return n.Rf.success({incidents:F,pagination:{total:T.length,limit:E,offset:O,hasMore:O+E<T.length}})}),R=(0,n.xX)(async r=>{let m=await auth(),_=await n.gx.requireUser(o,m.user.email),{organizationId:h,title:P,description:f,severity:E="medium",status:O="investigating",affectedServices:A,impactDescription:T,assignedTo:F,createdBy:q,source:X="manual"}=await n.gx.parseRequestBody(r,["organizationId","title"]);n.cX.uuid(h,"organizationId"),n.cX.enum(E,["critical","high","medium","low","maintenance"],"severity"),n.cX.enum(O,["open","investigating","identified","monitoring","resolved"],"status"),n.cX.enum(X,["manual","monitoring","api"],"source"),await n.gx.requireOrganizationMember(o,h,_.id,["owner","admin","responder"]);let J={organization_id:h,title:n.cX.sanitizeHtml(P),description:n.cX.sanitizeHtml(f),severity:E,status:O,affected_services:A||[],impact_description:n.cX.sanitizeHtml(T),assigned_to:F,created_by:q||_.id,source:X},M=await o.createIncident(J);return $(M,h).catch(W=>{console.error("Failed to send incident notifications:",W)}),n.Rf.success({incident:M},"Incident created successfully",201)}),I=(0,n.xX)(async r=>{let m=await auth(),_=await n.gx.requireUser(o,m.user.email),{id:h,title:P,description:f,severity:E,status:O,affectedServices:A,impactDescription:T,assignedTo:F,resolvedAt:q,acknowledgedAt:X}=await n.gx.parseRequestBody(r,["id"]);n.cX.uuid(h,"id"),E&&n.cX.enum(E,["critical","high","medium","low","maintenance"],"severity"),O&&n.cX.enum(O,["open","investigating","identified","monitoring","resolved"],"status");let J=await o.getIncidentById(h);if(!J)return n.Rf.notFound("Incident");await n.gx.requireOrganizationMember(o,J.organization_id,_.id,["owner","admin","responder"]);let M={};P!==void 0&&(M.title=n.cX.sanitizeHtml(P)),f!==void 0&&(M.description=n.cX.sanitizeHtml(f)),E!==void 0&&(M.severity=E),O!==void 0&&(M.status=O),A!==void 0&&(M.affected_services=A),T!==void 0&&(M.impact_description=n.cX.sanitizeHtml(T)),F!==void 0&&(M.assigned_to=F),q!==void 0&&(M.resolved_at=q),X!==void 0&&(M.acknowledged_at=X);let W=await o.updateIncident(h,M);return n.Rf.success({incident:W},"Incident updated successfully")}),S=(0,n.xX)(async r=>{let m=await auth(),_=await n.gx.requireUser(o,m.user.email),{searchParams:h}=new URL(r.url),P=h.get("id");if(!P)return n.Rf.badRequest("Incident ID is required");n.cX.uuid(P,"id");let f=await o.getIncidentById(P);return f?(await n.gx.requireOrganizationMember(o,f.organization_id,_.id,["owner","admin"]),await o.deleteIncident(P),n.Rf.success({},"Incident deleted successfully")):n.Rf.notFound("Incident")}),j=new l.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/incidents/route",pathname:"/api/incidents",filename:"route",bundlePath:"app/api/incidents/route"},resolvedPagePath:"/Users/sean/git/alert24-app/app/api/incidents/route.js",nextConfigOutput:"",userland:i}),{requestAsyncStorage:z,staticGenerationAsyncStorage:K,serverHooks:D}=j,Q="/api/incidents/route";function B(){return(0,e.XH)({serverHooks:D,staticGenerationAsyncStorage:K})}let G=d,C=c.a.wrap(j)},6095:ke,7138:xe,5856:fe},w=>{var p=i=>w(w.s=i);w.O(0,[2720,7883,1377,3452,6006],()=>p(6265));var a=w.O();(b._ENTRIES=typeof b._ENTRIES>"u"?{}:b._ENTRIES)["middleware_app/api/incidents/route"]=a}]),function(){let w={exports:{},loaded:!1};return function(a,i){var d=Object.create,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,e=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,n=r=>c(r,"__esModule",{value:!0}),u=(r,m)=>{n(r);for(var _ in m)c(r,_,{get:m[_],enumerable:!0})},o=(r,m,_)=>{if(m&&typeof m=="object"||typeof m=="function")for(let h of t(m))!s.call(r,h)&&h!=="default"&&c(r,h,{get:()=>m[h],enumerable:!(_=l(m,h))||_.enumerable});return r},x=r=>o(n(c(r!=null?d(e(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);u(i,{default:()=>Q});var $=x((te(),oe(H))),y="@next/request-context",R=Symbol.for(y),I=Symbol.for("internal.storage");function S(){let r=b;if(!r[R]){let m=new $.AsyncLocalStorage,_={get:()=>m.getStore(),[I]:m};r[R]=_}return r[R]}var j=S();function z(r,m){return j[I].run(r,m)}function K(r){let m={};return r&&r.forEach((_,h)=>{m[h]=_,h.toLowerCase()==="set-cookie"&&(m[h]=D(_))}),m}function D(r){let m=[],_=0,h,P,f,E,O;function A(){for(;_<r.length&&/\s/.test(r.charAt(_));)_+=1;return _<r.length}function T(){return P=r.charAt(_),P!=="="&&P!==";"&&P!==","}for(;_<r.length;){for(h=_,O=!1;A();)if(P=r.charAt(_),P===","){for(f=_,_+=1,A(),E=_;_<r.length&&T();)_+=1;_<r.length&&r.charAt(_)==="="?(O=!0,_=E,m.push(r.substring(h,f)),h=_):_=f+1}else _+=1;(!O||_>=r.length)&&m.push(r.substring(h,r.length))}return m}function Q(r){let m=r.staticRoutes.map(h=>({regexp:new RegExp(h.namedRegex),page:h.page})),_=r.dynamicRoutes?.map(h=>({regexp:new RegExp(h.namedRegex),page:h.page}))||[];return async function(h,P){let f=new URL(h.url).pathname,E={};if(r.nextConfig?.basePath&&f.startsWith(r.nextConfig.basePath)&&(f=f.replace(r.nextConfig.basePath,"")||"/"),r.nextConfig?.i18n)for(let A of r.nextConfig.i18n.locales){let T=new RegExp(`^/${A}($|/)`,"i");if(f.match(T)){f=f.replace(T,"/")||"/";break}}for(let A of m)if(A.regexp.exec(f)){E.name=A.page;break}if(!E.name){let A=G(f);for(let T of _||[]){if(A&&!G(T.page))continue;let F=T.regexp.exec(f);if(F){E={name:T.page,params:F.groups};break}}}let O=await z({waitUntil:P.waitUntil},()=>b._ENTRIES[`middleware_${r.name}`].default.call({},{request:{url:h.url,method:h.method,headers:K(h.headers),ip:B(h.headers,C.Ip),geo:{city:B(h.headers,C.City,!0),country:B(h.headers,C.Country,!0),latitude:B(h.headers,C.Latitude),longitude:B(h.headers,C.Longitude),region:B(h.headers,C.Region,!0)},nextConfig:r.nextConfig,page:E,body:h.body}}));return O.waitUntil&&P.waitUntil(O.waitUntil),O.response}}function B(r,m,_=!1){let h=r.get(m)||void 0;return _&&h?decodeURIComponent(h):h}function G(r){return r==="/api"||r.startsWith("/api/")}var C;(function(r){r.City="x-vercel-ip-city",r.Country="x-vercel-ip-country",r.Ip="x-real-ip",r.Latitude="x-vercel-ip-latitude",r.Longitude="x-vercel-ip-longitude",r.Region="x-vercel-ip-country-region"})(C||(C={}))}(w,w.exports),w.exports}.call({}).default({name:"app/api/incidents/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/accept-invitation",regex:"^/accept\\-invitation(?:/)?$",routeKeys:{},namedRegex:"^/accept\\-invitation(?:/)?$"},{page:"/debug-email",regex:"^/debug\\-email(?:/)?$",routeKeys:{},namedRegex:"^/debug\\-email(?:/)?$"},{page:"/debug-monitoring",regex:"^/debug\\-monitoring(?:/)?$",routeKeys:{},namedRegex:"^/debug\\-monitoring(?:/)?$"},{page:"/escalation-policies/new",regex:"^/escalation\\-policies/new(?:/)?$",routeKeys:{},namedRegex:"^/escalation\\-policies/new(?:/)?$"},{page:"/favicon.ico",regex:"^/favicon\\.ico(?:/)?$",routeKeys:{},namedRegex:"^/favicon\\.ico(?:/)?$"},{page:"/help",regex:"^/help(?:/)?$",routeKeys:{},namedRegex:"^/help(?:/)?$"},{page:"/incidents",regex:"^/incidents(?:/)?$",routeKeys:{},namedRegex:"^/incidents(?:/)?$"},{page:"/incidents/new",regex:"^/incidents/new(?:/)?$",routeKeys:{},namedRegex:"^/incidents/new(?:/)?$"},{page:"/monitoring",regex:"^/monitoring(?:/)?$",routeKeys:{},namedRegex:"^/monitoring(?:/)?$"},{page:"/monitoring/new",regex:"^/monitoring/new(?:/)?$",routeKeys:{},namedRegex:"^/monitoring/new(?:/)?$"},{page:"/on-call",regex:"^/on\\-call(?:/)?$",routeKeys:{},namedRegex:"^/on\\-call(?:/)?$"},{page:"/on-call/new",regex:"^/on\\-call/new(?:/)?$",routeKeys:{},namedRegex:"^/on\\-call/new(?:/)?$"},{page:"/organizations",regex:"^/organizations(?:/)?$",routeKeys:{},namedRegex:"^/organizations(?:/)?$"},{page:"/profile",regex:"^/profile(?:/)?$",routeKeys:{},namedRegex:"^/profile(?:/)?$"},{page:"/settings",regex:"^/settings(?:/)?$",routeKeys:{},namedRegex:"^/settings(?:/)?$"},{page:"/status-pages",regex:"^/status\\-pages(?:/)?$",routeKeys:{},namedRegex:"^/status\\-pages(?:/)?$"}],dynamicRoutes:[{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"},{page:"/api/incidents/[id]",regex:"^/api/incidents/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/incidents/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/incidents/[id]/updates",regex:"^/api/incidents/([^/]+?)/updates(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/incidents/(?<nxtPid>[^/]+?)/updates(?:/)?$"},{page:"/api/monitoring/[id]",regex:"^/api/monitoring/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/monitoring/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/on-call-schedules/[id]",regex:"^/api/on\\-call\\-schedules/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/on\\-call\\-schedules/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/organizations/[id]",regex:"^/api/organizations/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/organizations/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/organizations/[id]/invitations",regex:"^/api/organizations/([^/]+?)/invitations(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/organizations/(?<nxtPid>[^/]+?)/invitations(?:/)?$"},{page:"/api/services/[id]",regex:"^/api/services/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/services/[id]/monitoring",regex:"^/api/services/([^/]+?)/monitoring(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)/monitoring(?:/)?$"},{page:"/api/services/[id]/sla",regex:"^/api/services/([^/]+?)/sla(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/services/(?<nxtPid>[^/]+?)/sla(?:/)?$"},{page:"/api/status-pages/public/[slug]",regex:"^/api/status\\-pages/public/([^/]+?)(?:/)?$",routeKeys:{nxtPslug:"nxtPslug"},namedRegex:"^/api/status\\-pages/public/(?<nxtPslug>[^/]+?)(?:/)?$"},{page:"/api/status-pages/[id]",regex:"^/api/status\\-pages/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/status\\-pages/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/incidents/[id]",regex:"^/incidents/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/incidents/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/incidents/[id]/edit",regex:"^/incidents/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/incidents/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/monitoring/edit/[id]",regex:"^/monitoring/edit/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/monitoring/edit/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/on-call/[id]/edit",regex:"^/on\\-call/([^/]+?)/edit(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/on\\-call/(?<nxtPid>[^/]+?)/edit(?:/)?$"},{page:"/status/[slug]",regex:"^/status/([^/]+?)(?:/)?$",routeKeys:{nxtPslug:"nxtPslug"},namedRegex:"^/status/(?<nxtPslug>[^/]+?)(?:/)?$"}],nextConfig:{basePath:""}})))(v,v,v);export{Gt as default};
